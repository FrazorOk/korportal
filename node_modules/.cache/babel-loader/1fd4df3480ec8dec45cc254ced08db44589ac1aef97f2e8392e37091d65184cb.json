{"ast":null,"code":"import{graphConfig}from'../authConfig';/**\r\n * Attaches a given access token to a MS Graph API call. Returns information about the user\r\n * @param accessToken\r\n */export async function callMe(accessToken){const headers=new Headers();const bearer=`Bearer ${accessToken}`;headers.append('Authorization',bearer);const options={method:'GET',headers:headers};return fetch(graphConfig.graphMeEndpoint,options).then(response=>response.json()).catch(error=>console.log(error));}export async function callPhoto(accessToken){const headers=new Headers();const bearer=`Bearer ${accessToken}`;headers.append('Authorization',bearer);const options={method:'GET',headers:headers};return fetch('https://graph.microsoft.com/v1.0/me/photo/$value',options).then(response=>response).catch(error=>console.log(error));}export async function getGroups(accessToken){const headers=new Headers();const bearer=`Bearer ${accessToken}`;headers.append('Authorization',bearer);const options={method:'GET',headers:headers};return fetch('https://graph.microsoft.com/beta/groups',options).then(response=>response).catch(error=>console.log(error));}export async function getAllUsers(accessToken){const headers=new Headers();const bearer=`Bearer ${accessToken}`;headers.append('Authorization',bearer);const options={method:'GET',headers:headers};return fetch('https://graph.microsoft.com/v1.0/users?$top=999&$select=DisplayName,accountEnabled,userPrincipalName,jobTitle,onPremisesExtensionAttributes,id',options).then(response=>response).catch(error=>console.log(error));}export async function getPhotoUser(accessToken,id){const headers=new Headers();const bearer=`Bearer ${accessToken}`;headers.append('Authorization',bearer);const options={method:'GET',headers:headers};return fetch(`https://graph.microsoft.com/v1.0/users/${id}/photo/$value`,options).then(response=>{if(response){return response;}}).catch(error=>{console.log(error);});}export async function getStructureCompany(accessToken){// Отримує людей які підпорядковуються цій людині ІД\nconst headers=new Headers();const bearer=`Bearer ${accessToken}`;headers.append('Authorization',bearer);const options={method:'GET',headers:headers};// 4af0fe36-d384-4634-a344-f706b61c1158  --- ID Бобровского Сергія\n// /users/{id | userPrincipalName}/manager  --- Дізнатися керівника юзера\nreturn fetch('https://graph.microsoft.com/v1.0/users/4af0fe36-d384-4634-a344-f706b61c1158/directReports',options).then(response=>response).catch(error=>console.log(error));}","map":{"version":3,"names":["graphConfig","callMe","accessToken","headers","Headers","bearer","append","options","method","fetch","graphMeEndpoint","then","response","json","catch","error","console","log","callPhoto","getGroups","getAllUsers","getPhotoUser","id","getStructureCompany"],"sources":["E:/web/web/2024/korportal/src/api/graph.js"],"sourcesContent":["import { graphConfig } from '../authConfig';\r\n\r\n/**\r\n * Attaches a given access token to a MS Graph API call. Returns information about the user\r\n * @param accessToken\r\n */\r\nexport async function callMe(accessToken) {\r\n\tconst headers = new Headers();\r\n\tconst bearer = `Bearer ${accessToken}`;\r\n\r\n\theaders.append('Authorization', bearer);\r\n\r\n\tconst options = {\r\n\t\tmethod: 'GET',\r\n\t\theaders: headers,\r\n\t};\r\n\r\n\treturn fetch(graphConfig.graphMeEndpoint, options)\r\n\t\t.then((response) => response.json())\r\n\t\t.catch((error) => console.log(error));\r\n}\r\nexport async function callPhoto(accessToken) {\r\n\tconst headers = new Headers();\r\n\tconst bearer = `Bearer ${accessToken}`;\r\n\r\n\theaders.append('Authorization', bearer);\r\n\tconst options = {\r\n\t\tmethod: 'GET',\r\n\t\theaders: headers,\r\n\t};\r\n\r\n\treturn fetch('https://graph.microsoft.com/v1.0/me/photo/$value', options)\r\n\t\t.then((response) => response)\r\n\t\t.catch((error) => console.log(error));\r\n}\r\nexport async function getGroups(accessToken) {\r\n\tconst headers = new Headers();\r\n\tconst bearer = `Bearer ${accessToken}`;\r\n\r\n\theaders.append('Authorization', bearer);\r\n\tconst options = {\r\n\t\tmethod: 'GET',\r\n\t\theaders: headers,\r\n\t};\r\n\r\n\treturn fetch('https://graph.microsoft.com/beta/groups', options)\r\n\t\t.then((response) => response)\r\n\t\t.catch((error) => console.log(error));\r\n}\r\nexport async function getAllUsers(accessToken) {\r\n\tconst headers = new Headers();\r\n\tconst bearer = `Bearer ${accessToken}`;\r\n\r\n\theaders.append('Authorization', bearer);\r\n\tconst options = {\r\n\t\tmethod: 'GET',\r\n\t\theaders: headers,\r\n\t};\r\n\r\n\treturn fetch(\r\n\t\t'https://graph.microsoft.com/v1.0/users?$top=999&$select=DisplayName,accountEnabled,userPrincipalName,jobTitle,onPremisesExtensionAttributes,id',\r\n\t\toptions\r\n\t)\r\n\t\t.then((response) => response)\r\n\t\t.catch((error) => console.log(error));\r\n}\r\nexport async function getPhotoUser(accessToken, id) {\r\n\tconst headers = new Headers();\r\n\tconst bearer = `Bearer ${accessToken}`;\r\n\r\n\theaders.append('Authorization', bearer);\r\n\tconst options = {\r\n\t\tmethod: 'GET',\r\n\t\theaders: headers,\r\n\t};\r\n\r\n\treturn fetch(`https://graph.microsoft.com/v1.0/users/${id}/photo/$value`, options)\r\n\t\t.then((response) => {\r\n\t\t\tif (response) {\r\n\t\t\t\treturn response;\r\n\t\t\t}\r\n\t\t})\r\n\t\t.catch((error) => {\r\n\t\t\tconsole.log(error);\r\n\t\t});\r\n}\r\nexport async function getStructureCompany(accessToken) {\r\n\t// Отримує людей які підпорядковуються цій людині ІД\r\n\tconst headers = new Headers();\r\n\tconst bearer = `Bearer ${accessToken}`;\r\n\r\n\theaders.append('Authorization', bearer);\r\n\tconst options = {\r\n\t\tmethod: 'GET',\r\n\t\theaders: headers,\r\n\t};\r\n\r\n\t// 4af0fe36-d384-4634-a344-f706b61c1158  --- ID Бобровского Сергія\r\n\t// /users/{id | userPrincipalName}/manager  --- Дізнатися керівника юзера\r\n\r\n\treturn fetch('https://graph.microsoft.com/v1.0/users/4af0fe36-d384-4634-a344-f706b61c1158/directReports', options)\r\n\t\t.then((response) => response)\r\n\t\t.catch((error) => console.log(error));\r\n}\r\n"],"mappings":"AAAA,OAASA,WAAW,KAAQ,eAAe,CAE3C;AACA;AACA;AACA,GACA,MAAO,eAAe,CAAAC,MAAMA,CAACC,WAAW,CAAE,CACzC,KAAM,CAAAC,OAAO,CAAG,GAAI,CAAAC,OAAO,CAAC,CAAC,CAC7B,KAAM,CAAAC,MAAM,CAAG,UAAUH,WAAW,EAAE,CAEtCC,OAAO,CAACG,MAAM,CAAC,eAAe,CAAED,MAAM,CAAC,CAEvC,KAAM,CAAAE,OAAO,CAAG,CACfC,MAAM,CAAE,KAAK,CACbL,OAAO,CAAEA,OACV,CAAC,CAED,MAAO,CAAAM,KAAK,CAACT,WAAW,CAACU,eAAe,CAAEH,OAAO,CAAC,CAChDI,IAAI,CAAEC,QAAQ,EAAKA,QAAQ,CAACC,IAAI,CAAC,CAAC,CAAC,CACnCC,KAAK,CAAEC,KAAK,EAAKC,OAAO,CAACC,GAAG,CAACF,KAAK,CAAC,CAAC,CACvC,CACA,MAAO,eAAe,CAAAG,SAASA,CAAChB,WAAW,CAAE,CAC5C,KAAM,CAAAC,OAAO,CAAG,GAAI,CAAAC,OAAO,CAAC,CAAC,CAC7B,KAAM,CAAAC,MAAM,CAAG,UAAUH,WAAW,EAAE,CAEtCC,OAAO,CAACG,MAAM,CAAC,eAAe,CAAED,MAAM,CAAC,CACvC,KAAM,CAAAE,OAAO,CAAG,CACfC,MAAM,CAAE,KAAK,CACbL,OAAO,CAAEA,OACV,CAAC,CAED,MAAO,CAAAM,KAAK,CAAC,kDAAkD,CAAEF,OAAO,CAAC,CACvEI,IAAI,CAAEC,QAAQ,EAAKA,QAAQ,CAAC,CAC5BE,KAAK,CAAEC,KAAK,EAAKC,OAAO,CAACC,GAAG,CAACF,KAAK,CAAC,CAAC,CACvC,CACA,MAAO,eAAe,CAAAI,SAASA,CAACjB,WAAW,CAAE,CAC5C,KAAM,CAAAC,OAAO,CAAG,GAAI,CAAAC,OAAO,CAAC,CAAC,CAC7B,KAAM,CAAAC,MAAM,CAAG,UAAUH,WAAW,EAAE,CAEtCC,OAAO,CAACG,MAAM,CAAC,eAAe,CAAED,MAAM,CAAC,CACvC,KAAM,CAAAE,OAAO,CAAG,CACfC,MAAM,CAAE,KAAK,CACbL,OAAO,CAAEA,OACV,CAAC,CAED,MAAO,CAAAM,KAAK,CAAC,yCAAyC,CAAEF,OAAO,CAAC,CAC9DI,IAAI,CAAEC,QAAQ,EAAKA,QAAQ,CAAC,CAC5BE,KAAK,CAAEC,KAAK,EAAKC,OAAO,CAACC,GAAG,CAACF,KAAK,CAAC,CAAC,CACvC,CACA,MAAO,eAAe,CAAAK,WAAWA,CAAClB,WAAW,CAAE,CAC9C,KAAM,CAAAC,OAAO,CAAG,GAAI,CAAAC,OAAO,CAAC,CAAC,CAC7B,KAAM,CAAAC,MAAM,CAAG,UAAUH,WAAW,EAAE,CAEtCC,OAAO,CAACG,MAAM,CAAC,eAAe,CAAED,MAAM,CAAC,CACvC,KAAM,CAAAE,OAAO,CAAG,CACfC,MAAM,CAAE,KAAK,CACbL,OAAO,CAAEA,OACV,CAAC,CAED,MAAO,CAAAM,KAAK,CACX,gJAAgJ,CAChJF,OACD,CAAC,CACCI,IAAI,CAAEC,QAAQ,EAAKA,QAAQ,CAAC,CAC5BE,KAAK,CAAEC,KAAK,EAAKC,OAAO,CAACC,GAAG,CAACF,KAAK,CAAC,CAAC,CACvC,CACA,MAAO,eAAe,CAAAM,YAAYA,CAACnB,WAAW,CAAEoB,EAAE,CAAE,CACnD,KAAM,CAAAnB,OAAO,CAAG,GAAI,CAAAC,OAAO,CAAC,CAAC,CAC7B,KAAM,CAAAC,MAAM,CAAG,UAAUH,WAAW,EAAE,CAEtCC,OAAO,CAACG,MAAM,CAAC,eAAe,CAAED,MAAM,CAAC,CACvC,KAAM,CAAAE,OAAO,CAAG,CACfC,MAAM,CAAE,KAAK,CACbL,OAAO,CAAEA,OACV,CAAC,CAED,MAAO,CAAAM,KAAK,CAAC,0CAA0Ca,EAAE,eAAe,CAAEf,OAAO,CAAC,CAChFI,IAAI,CAAEC,QAAQ,EAAK,CACnB,GAAIA,QAAQ,CAAE,CACb,MAAO,CAAAA,QAAQ,CAChB,CACD,CAAC,CAAC,CACDE,KAAK,CAAEC,KAAK,EAAK,CACjBC,OAAO,CAACC,GAAG,CAACF,KAAK,CAAC,CACnB,CAAC,CAAC,CACJ,CACA,MAAO,eAAe,CAAAQ,mBAAmBA,CAACrB,WAAW,CAAE,CACtD;AACA,KAAM,CAAAC,OAAO,CAAG,GAAI,CAAAC,OAAO,CAAC,CAAC,CAC7B,KAAM,CAAAC,MAAM,CAAG,UAAUH,WAAW,EAAE,CAEtCC,OAAO,CAACG,MAAM,CAAC,eAAe,CAAED,MAAM,CAAC,CACvC,KAAM,CAAAE,OAAO,CAAG,CACfC,MAAM,CAAE,KAAK,CACbL,OAAO,CAAEA,OACV,CAAC,CAED;AACA;AAEA,MAAO,CAAAM,KAAK,CAAC,2FAA2F,CAAEF,OAAO,CAAC,CAChHI,IAAI,CAAEC,QAAQ,EAAKA,QAAQ,CAAC,CAC5BE,KAAK,CAAEC,KAAK,EAAKC,OAAO,CAACC,GAAG,CAACF,KAAK,CAAC,CAAC,CACvC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}