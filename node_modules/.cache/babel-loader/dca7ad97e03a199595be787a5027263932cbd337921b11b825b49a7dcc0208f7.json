{"ast":null,"code":"import s from'./GalleryList.module.css';import arrowIcon from'../../assets/img/icons/arrow-down-icon.svg';import clockIcon from'../../assets/img/icons/clock-icon.svg';import{useEffect,useState}from'react';import{Link}from'react-router-dom';import Loader from'../UI/Loader/Loader';import EditAdminButton from'../UI/EditAdminButton/EditAdminButton';import{reversDateWithoutTime}from'../../helpers/dateConverter';// {\n// \tgalleryItem &&\n// \t\tisCurrentGalleryList[indexGalleryItem - 1] &&\n// \t\tgalleryItem.create_date.slice(0, 4) !== isCurrentGalleryList[indexGalleryItem - 1].create_date.slice(0, 4) && (\n// \t\t\t<p style={{ width: '100%' }}>{galleryItem.create_date.slice(0, 4)}</p>\n// \t\t);\n// }\n// {\n// \tindexGalleryItem === 0 && <p style={{ width: '100%' }}>{galleryItem.create_date.slice(0, 4)}</p>;\n// }\nimport{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const GalleryList=_ref=>{let{galleryList,adminStatus=false}=_ref;let[isGalleryList,setGalleryList]=useState([]);let[isCurrentGalleryList,setCurrentGalleryList]=useState([]);let[isPaginationIndex,setPaginationIndex]=useState(1);let[endPage,setEndPage]=useState(0);const handleScroll=e=>{let block=e.currentTarget;// Відступ до кінця блоку\nlet y=0;console.log(galleryList);console.log(isGalleryList);console.log(isCurrentGalleryList);if(Math.ceil(block.scrollTop+block.clientHeight)>=Math.ceil(block.scrollHeight)-y){console.log('end');setEndPage(item=>item+1);if(isGalleryList.length>=20&&isCurrentGalleryList.length<isGalleryList.length){setPaginationIndex(index=>index+1);}}};useEffect(()=>{let el=document.querySelector('.main-scroll-block');el.addEventListener('scroll',e=>handleScroll(e));return()=>{el.removeEventListener('scroll',e=>handleScroll(e));};},[]);useEffect(()=>{if(galleryList&&galleryList.length>0){setGalleryList(galleryList);}},[galleryList]);useEffect(()=>{if(isGalleryList&&isGalleryList.length>0){setCurrentGalleryList(array=>[...array,...isGalleryList.slice(20*(isPaginationIndex-1),20*isPaginationIndex)]);}},[isGalleryList,isPaginationIndex]);useEffect(()=>{console.log(galleryList);console.log(isGalleryList);console.log(isCurrentGalleryList);},[endPage]);return/*#__PURE__*/_jsx(\"div\",{className:s.list,children:isCurrentGalleryList&&isCurrentGalleryList.length>0?isCurrentGalleryList.map(galleryItem=>{if(galleryItem){return/*#__PURE__*/_jsxs(Link,{to:`/gallery/${galleryItem.id}`,className:s.item,children:[galleryItem.cover&&/*#__PURE__*/_jsx(\"img\",{className:s.main_img,src:`${galleryItem.cover}`}),/*#__PURE__*/_jsxs(\"p\",{className:s.item_title,children:[/*#__PURE__*/_jsxs(\"span\",{className:s.item_date,children:[/*#__PURE__*/_jsx(\"img\",{src:clockIcon,alt:\"\"}),\" \",reversDateWithoutTime(galleryItem.create_date)]}),galleryItem.title]}),/*#__PURE__*/_jsxs(\"span\",{className:s.item_btn,href:\"\",children:[\"\\u041F\\u0435\\u0440\\u0435\\u0433\\u043B\\u044F\\u043D\\u0443\\u0442\\u0438\",/*#__PURE__*/_jsx(\"img\",{src:arrowIcon,alt:\"\"})]}),adminStatus&&/*#__PURE__*/_jsx(EditAdminButton,{link:`add-change-gallery/${galleryItem.id}`})]},`${galleryItem.id}gallery`);}}):/*#__PURE__*/_jsx(Loader,{})});};export default GalleryList;","map":{"version":3,"names":["s","arrowIcon","clockIcon","useEffect","useState","Link","Loader","EditAdminButton","reversDateWithoutTime","jsx","_jsx","jsxs","_jsxs","GalleryList","_ref","galleryList","adminStatus","isGalleryList","setGalleryList","isCurrentGalleryList","setCurrentGalleryList","isPaginationIndex","setPaginationIndex","endPage","setEndPage","handleScroll","e","block","currentTarget","y","console","log","Math","ceil","scrollTop","clientHeight","scrollHeight","item","length","index","el","document","querySelector","addEventListener","removeEventListener","array","slice","className","list","children","map","galleryItem","to","id","cover","main_img","src","item_title","item_date","alt","create_date","title","item_btn","href","link"],"sources":["E:/web/web/2024/korportal/src/components/GalleryList/GalleryList.jsx"],"sourcesContent":["import s from './GalleryList.module.css';\r\nimport arrowIcon from '../../assets/img/icons/arrow-down-icon.svg';\r\nimport clockIcon from '../../assets/img/icons/clock-icon.svg';\r\nimport { useEffect, useState } from 'react';\r\nimport { Link } from 'react-router-dom';\r\nimport Loader from '../UI/Loader/Loader';\r\nimport EditAdminButton from '../UI/EditAdminButton/EditAdminButton';\r\nimport { reversDateWithoutTime } from '../../helpers/dateConverter';\r\n\r\n// {\r\n// \tgalleryItem &&\r\n// \t\tisCurrentGalleryList[indexGalleryItem - 1] &&\r\n// \t\tgalleryItem.create_date.slice(0, 4) !== isCurrentGalleryList[indexGalleryItem - 1].create_date.slice(0, 4) && (\r\n// \t\t\t<p style={{ width: '100%' }}>{galleryItem.create_date.slice(0, 4)}</p>\r\n// \t\t);\r\n// }\r\n// {\r\n// \tindexGalleryItem === 0 && <p style={{ width: '100%' }}>{galleryItem.create_date.slice(0, 4)}</p>;\r\n// }\r\n\r\nconst GalleryList = ({ galleryList, adminStatus = false }) => {\r\n\tlet [isGalleryList, setGalleryList] = useState([]);\r\n\tlet [isCurrentGalleryList, setCurrentGalleryList] = useState([]);\r\n\tlet [isPaginationIndex, setPaginationIndex] = useState(1);\r\n\tlet [endPage, setEndPage] = useState(0);\r\n\r\n\tconst handleScroll = (e) => {\r\n\t\tlet block = e.currentTarget;\r\n\t\t// Відступ до кінця блоку\r\n\t\tlet y = 0;\r\n\r\n\t\tconsole.log(galleryList);\r\n\t\tconsole.log(isGalleryList);\r\n\t\tconsole.log(isCurrentGalleryList);\r\n\r\n\t\tif (Math.ceil(block.scrollTop + block.clientHeight) >= Math.ceil(block.scrollHeight) - y) {\r\n\t\t\tconsole.log('end');\r\n\t\t\tsetEndPage((item) => item + 1);\r\n\r\n\t\t\tif (isGalleryList.length >= 20 && isCurrentGalleryList.length < isGalleryList.length) {\r\n\t\t\t\tsetPaginationIndex((index) => index + 1);\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n\r\n\tuseEffect(() => {\r\n\t\tlet el = document.querySelector('.main-scroll-block');\r\n\t\tel.addEventListener('scroll', (e) => handleScroll(e));\r\n\t\treturn () => {\r\n\t\t\tel.removeEventListener('scroll', (e) => handleScroll(e));\r\n\t\t};\r\n\t}, []);\r\n\tuseEffect(() => {\r\n\t\tif (galleryList && galleryList.length > 0) {\r\n\t\t\tsetGalleryList(galleryList);\r\n\t\t}\r\n\t}, [galleryList]);\r\n\tuseEffect(() => {\r\n\t\tif (isGalleryList && isGalleryList.length > 0) {\r\n\t\t\tsetCurrentGalleryList((array) => [...array, ...isGalleryList.slice(20 * (isPaginationIndex - 1), 20 * isPaginationIndex)]);\r\n\t\t}\r\n\t}, [isGalleryList, isPaginationIndex]);\r\n\r\n\tuseEffect(() => {\r\n\t\tconsole.log(galleryList);\r\n\t\tconsole.log(isGalleryList);\r\n\t\tconsole.log(isCurrentGalleryList);\r\n\t}, [endPage]);\r\n\r\n\treturn (\r\n\t\t<div className={s.list}>\r\n\t\t\t{isCurrentGalleryList && isCurrentGalleryList.length > 0 ? (\r\n\t\t\t\tisCurrentGalleryList.map((galleryItem) => {\r\n\t\t\t\t\tif (galleryItem) {\r\n\t\t\t\t\t\treturn (\r\n\t\t\t\t\t\t\t<Link to={`/gallery/${galleryItem.id}`} className={s.item} key={`${galleryItem.id}gallery`}>\r\n\t\t\t\t\t\t\t\t{galleryItem.cover && <img className={s.main_img} src={`${galleryItem.cover}`} />}\r\n\t\t\t\t\t\t\t\t<p className={s.item_title}>\r\n\t\t\t\t\t\t\t\t\t<span className={s.item_date}>\r\n\t\t\t\t\t\t\t\t\t\t<img src={clockIcon} alt=\"\" /> {reversDateWithoutTime(galleryItem.create_date)}\r\n\t\t\t\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t\t\t\t{galleryItem.title}\r\n\t\t\t\t\t\t\t\t</p>\r\n\t\t\t\t\t\t\t\t<span className={s.item_btn} href=\"\">\r\n\t\t\t\t\t\t\t\t\tПереглянути\r\n\t\t\t\t\t\t\t\t\t<img src={arrowIcon} alt=\"\" />\r\n\t\t\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t\t\t{adminStatus && <EditAdminButton link={`add-change-gallery/${galleryItem.id}`} />}\r\n\t\t\t\t\t\t\t</Link>\r\n\t\t\t\t\t\t);\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t) : (\r\n\t\t\t\t<Loader />\r\n\t\t\t)}\r\n\t\t</div>\r\n\t);\r\n};\r\n\r\nexport default GalleryList;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}