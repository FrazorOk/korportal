{"ast":null,"code":"import s from'./EventSection.module.css';import calendarIcon from'../../../assets/img/icons/calendar-icon.svg';import{memo,useEffect,useState}from'react';import{getNews}from'../../../api/api';import{dateConverterFromYMD}from'../../../helpers/dateConverter';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const dateToYMD=(date,year)=>{let d=date.getDate();let m=date.getMonth()+1;return new Date(''+year+'-'+(m<=9?'0'+m:m)+'-'+(d<=9?'0'+d:d));};const dateToYMDArray=(date,year)=>{let d=date.slice(8,10);let m=date.slice(5,7);return new Date(''+year+'-'+m+'-'+d);};const EventSection=()=>{let[data,setData]=useState(null);let[formatedData,setFormatedData]=useState(null);useEffect(()=>{getNews(setData,1,2);},[]);useEffect(()=>{if(data){// Константи для дат\nlet year=new Date().getFullYear();let nulledDay=new Date(`${year}-01-01`);let today=new Date();// сегодня\n// Створення індексу сортування та дат (для додавання у календар)\nlet filteredArray=data.map(item=>{if(item){// днів до сьогодні\nlet daysToday=Math.ceil(Math.abs(dateToYMD(today,year).getTime()-nulledDay.getTime())/(1000*3600*24));let allDaysInYear=Math.ceil(Math.abs(new Date(`${year}-12-31`).getTime()-nulledDay.getTime())/(1000*3600*24));let daysA=Math.ceil(Math.abs(dateToYMDArray(item.pub_date,year).getTime()-nulledDay.getTime())/(1000*3600*24));// date for calendar ms\nconst dayMilliseconds=24*60*60*1000;if(daysA-daysToday<0){// date for calendar ms\nlet dateInSeconds=dateToYMDArray(item.pub_date,year*1+1).setTime(dateToYMDArray(item.pub_date,year*1+1).getTime()-dayMilliseconds);let dateForCalendarBefor=encodeURI(new Date(dateInSeconds).toISOString()).slice(0,10);let dateForCalendarAfter=encodeURI(dateToYMDArray(item.pub_date,year*1+1).toISOString()).slice(0,10);return{...item,index:allDaysInYear+1+daysA-daysToday,dateForCalendar:{befor:dateForCalendarBefor,after:dateForCalendarAfter}};}// date for calendar ms\nlet dateInSeconds=dateToYMDArray(item.pub_date,year).setTime(dateToYMDArray(item.pub_date,year).getTime()-dayMilliseconds);let dateForCalendarBefor=encodeURI(new Date(dateInSeconds).toISOString()).slice(0,10);let dateForCalendarAfter=encodeURI(dateToYMDArray(item.pub_date,year).toISOString()).slice(0,10);return{...item,index:daysA-daysToday,dateForCalendar:{befor:dateForCalendarBefor,after:dateForCalendarAfter}};}else{return null;}});filteredArray.sort((a,b)=>a.index-b.index);setFormatedData(filteredArray);}},[data]);return/*#__PURE__*/_jsx(_Fragment,{children:data&&/*#__PURE__*/_jsx(\"div\",{className:s.events,children:formatedData&&formatedData.length>0&&formatedData.map(eventDate=>{if(eventDate){return/*#__PURE__*/_jsxs(\"div\",{className:s.events_item,children:[/*#__PURE__*/_jsx(\"p\",{children:eventDate.title}),/*#__PURE__*/_jsxs(\"div\",{className:s.events_bottom,children:[/*#__PURE__*/_jsxs(\"div\",{className:s.events_date_row,children:[/*#__PURE__*/_jsxs(\"p\",{children:[dateConverterFromYMD(eventDate.pub_date).day,\" \",/*#__PURE__*/_jsxs(\"span\",{children:[\" \",dateConverterFromYMD(eventDate.pub_date).month]})]}),/*#__PURE__*/_jsx(\"a\",{href:\"#\",children:/*#__PURE__*/_jsx(\"img\",{src:calendarIcon,alt:\"\"})})]}),/*#__PURE__*/_jsx(\"a\",{href:\"#\",className:s.events_link,children:\"\\u0423\\u0441\\u0456\"})]}),/*#__PURE__*/_jsx(\"span\",{className:s.figures})]});}})})});};export default/*#__PURE__*/memo(EventSection);","map":{"version":3,"names":["s","calendarIcon","memo","useEffect","useState","getNews","dateConverterFromYMD","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","dateToYMD","date","year","d","getDate","m","getMonth","Date","dateToYMDArray","slice","EventSection","data","setData","formatedData","setFormatedData","getFullYear","nulledDay","today","filteredArray","map","item","daysToday","Math","ceil","abs","getTime","allDaysInYear","daysA","pub_date","dayMilliseconds","dateInSeconds","setTime","dateForCalendarBefor","encodeURI","toISOString","dateForCalendarAfter","index","dateForCalendar","befor","after","sort","a","b","children","className","events","length","eventDate","events_item","title","events_bottom","events_date_row","day","month","href","src","alt","events_link","figures"],"sources":["E:/web/web/2024/korportal/src/pages/HomePage/EventSection/EventSection.jsx"],"sourcesContent":["import s from './EventSection.module.css';\r\nimport calendarIcon from '../../../assets/img/icons/calendar-icon.svg';\r\nimport { memo, useEffect, useState } from 'react';\r\nimport { getNews } from '../../../api/api';\r\nimport { dateConverterFromYMD } from '../../../helpers/dateConverter';\r\n\r\nconst dateToYMD = (date, year) => {\r\n\tlet d = date.getDate();\r\n\tlet m = date.getMonth() + 1;\r\n\treturn new Date('' + year + '-' + (m <= 9 ? '0' + m : m) + '-' + (d <= 9 ? '0' + d : d));\r\n};\r\nconst dateToYMDArray = (date, year) => {\r\n\tlet d = date.slice(8, 10);\r\n\tlet m = date.slice(5, 7);\r\n\treturn new Date('' + year + '-' + m + '-' + d);\r\n};\r\n\r\nconst EventSection = () => {\r\n\tlet [data, setData] = useState(null);\r\n\tlet [formatedData, setFormatedData] = useState(null);\r\n\r\n\tuseEffect(() => {\r\n\t\tgetNews(setData, 1, 2);\r\n\t}, []);\r\n\tuseEffect(() => {\r\n\t\tif (data) {\r\n\t\t\t// Константи для дат\r\n\t\t\tlet year = new Date().getFullYear();\r\n\t\t\tlet nulledDay = new Date(`${year}-01-01`);\r\n\t\t\tlet today = new Date(); // сегодня\r\n\r\n\t\t\t// Створення індексу сортування та дат (для додавання у календар)\r\n\t\t\tlet filteredArray = data.map((item) => {\r\n\t\t\t\tif (item) {\r\n\t\t\t\t\t// днів до сьогодні\r\n\t\t\t\t\tlet daysToday = Math.ceil(Math.abs(dateToYMD(today, year).getTime() - nulledDay.getTime()) / (1000 * 3600 * 24));\r\n\t\t\t\t\tlet allDaysInYear = Math.ceil(Math.abs(new Date(`${year}-12-31`).getTime() - nulledDay.getTime()) / (1000 * 3600 * 24));\r\n\t\t\t\t\tlet daysA = Math.ceil(Math.abs(dateToYMDArray(item.pub_date, year).getTime() - nulledDay.getTime()) / (1000 * 3600 * 24));\r\n\r\n\t\t\t\t\t// date for calendar ms\r\n\t\t\t\t\tconst dayMilliseconds = 24 * 60 * 60 * 1000;\r\n\r\n\t\t\t\t\tif (daysA - daysToday < 0) {\r\n\t\t\t\t\t\t// date for calendar ms\r\n\t\t\t\t\t\tlet dateInSeconds = dateToYMDArray(item.pub_date, year * 1 + 1).setTime(\r\n\t\t\t\t\t\t\tdateToYMDArray(item.pub_date, year * 1 + 1).getTime() - dayMilliseconds\r\n\t\t\t\t\t\t);\r\n\r\n\t\t\t\t\t\tlet dateForCalendarBefor = encodeURI(new Date(dateInSeconds).toISOString()).slice(0, 10);\r\n\t\t\t\t\t\tlet dateForCalendarAfter = encodeURI(dateToYMDArray(item.pub_date, year * 1 + 1).toISOString()).slice(0, 10);\r\n\r\n\t\t\t\t\t\treturn {\r\n\t\t\t\t\t\t\t...item,\r\n\t\t\t\t\t\t\tindex: allDaysInYear + 1 + daysA - daysToday,\r\n\t\t\t\t\t\t\tdateForCalendar: { befor: dateForCalendarBefor, after: dateForCalendarAfter },\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t// date for calendar ms\r\n\t\t\t\t\tlet dateInSeconds = dateToYMDArray(item.pub_date, year).setTime(dateToYMDArray(item.pub_date, year).getTime() - dayMilliseconds);\r\n\r\n\t\t\t\t\tlet dateForCalendarBefor = encodeURI(new Date(dateInSeconds).toISOString()).slice(0, 10);\r\n\t\t\t\t\tlet dateForCalendarAfter = encodeURI(dateToYMDArray(item.pub_date, year).toISOString()).slice(0, 10);\r\n\r\n\t\t\t\t\treturn {\r\n\t\t\t\t\t\t...item,\r\n\t\t\t\t\t\tindex: daysA - daysToday,\r\n\t\t\t\t\t\tdateForCalendar: { befor: dateForCalendarBefor, after: dateForCalendarAfter },\r\n\t\t\t\t\t};\r\n\t\t\t\t} else {\r\n\t\t\t\t\treturn null;\r\n\t\t\t\t}\r\n\t\t\t});\r\n\r\n\t\t\tfilteredArray.sort((a, b) => a.index - b.index);\r\n\r\n\t\t\tsetFormatedData(filteredArray);\r\n\t\t}\r\n\t}, [data]);\r\n\r\n\treturn (\r\n\t\t<>\r\n\t\t\t{data && (\r\n\t\t\t\t<div className={s.events}>\r\n\t\t\t\t\t{formatedData &&\r\n\t\t\t\t\t\tformatedData.length > 0 &&\r\n\t\t\t\t\t\tformatedData.map((eventDate) => {\r\n\t\t\t\t\t\t\tif (eventDate) {\r\n\t\t\t\t\t\t\t\treturn (\r\n\t\t\t\t\t\t\t\t\t<div className={s.events_item}>\r\n\t\t\t\t\t\t\t\t\t\t<p>{eventDate.title}</p>\r\n\t\t\t\t\t\t\t\t\t\t<div className={s.events_bottom}>\r\n\t\t\t\t\t\t\t\t\t\t\t<div className={s.events_date_row}>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<p>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t{dateConverterFromYMD(eventDate.pub_date).day} <span> {dateConverterFromYMD(eventDate.pub_date).month}</span>\r\n\t\t\t\t\t\t\t\t\t\t\t\t</p>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<a href=\"#\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<img src={calendarIcon} alt=\"\" />\r\n\t\t\t\t\t\t\t\t\t\t\t\t</a>\r\n\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t<a href=\"#\" className={s.events_link}>\r\n\t\t\t\t\t\t\t\t\t\t\t\tУсі\r\n\t\t\t\t\t\t\t\t\t\t\t</a>\r\n\t\t\t\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t\t\t\t\t<span className={s.figures}></span>\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t})}\r\n\t\t\t\t</div>\r\n\t\t\t)}\r\n\t\t</>\r\n\t);\r\n};\r\n\r\nexport default memo(EventSection);\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}