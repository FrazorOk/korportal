{"ast":null,"code":"import{useEffect,useState}from'react';import ModalWidnow from'../UI/ModalWidnow/ModalWidnow';import Loader from'../UI/Loader/Loader';import s from'./UserInfoModalWindow.module.css';import{getUserById}from'../../api/graph';import{useMsal}from'@azure/msal-react';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const UserInfoModalWindow=_ref=>{let{userId,visibleStatus,closeModal}=_ref;const{instance,accounts}=useMsal();let[userData,setUserData]=useState(false);let[userImg,setUserImg]=useState('');let[isFetching,setIsFetching]=useState(false);function RequestUsersData(){setIsFetching(true);instance.acquireTokenSilent({scopes:['User.Read.All'],account:accounts[0]}).then(response=>{getUserById(response.accessToken,userId).then(response=>response.json()).then(result=>{setIsFetching(false);setUserData(result);console.log(result);}).catch(rerror=>{setIsFetching(false);});});setTimeout(()=>{setIsFetching(false);},12000);}function RequestProfilePhoto(id){return instance.acquireTokenSilent({...loginRequest,account:accounts[0]}).then(response=>{return getPhotoUser(response.accessToken,id).then(response=>{if(response){return response.blob();}else{return'';}}).then(result=>{const url=window.URL||window.webkitURL;const blobUrl=url.createObjectURL(result);if(result.type==='application/json'){return'';}setUserImg(blobUrl);}).catch(error=>console.log(error));});}useEffect(()=>{console.log(userId);RequestUsersData();},[userId]);return/*#__PURE__*/_jsx(_Fragment,{children:visibleStatus&&/*#__PURE__*/_jsx(ModalWidnow,{closeModal:closeModal,children:isFetching?/*#__PURE__*/_jsx(Loader,{}):/*#__PURE__*/_jsx(_Fragment,{children:userData&&/*#__PURE__*/_jsx(\"div\",{className:s.info_container,children:/*#__PURE__*/_jsxs(\"div\",{className:s.user_row,children:[/*#__PURE__*/_jsx(\"img\",{className:s.user_img,src:userImg,alt:\"\"}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"p\",{className:s.user_title,children:userData.displayName}),/*#__PURE__*/_jsx(\"p\",{className:s.user_job,children:userData.jobTitle})]})]})})})})});};export default UserInfoModalWindow;","map":{"version":3,"names":["useEffect","useState","ModalWidnow","Loader","s","getUserById","useMsal","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","UserInfoModalWindow","_ref","userId","visibleStatus","closeModal","instance","accounts","userData","setUserData","userImg","setUserImg","isFetching","setIsFetching","RequestUsersData","acquireTokenSilent","scopes","account","then","response","accessToken","json","result","console","log","catch","rerror","setTimeout","RequestProfilePhoto","id","loginRequest","getPhotoUser","blob","url","window","URL","webkitURL","blobUrl","createObjectURL","type","error","children","className","info_container","user_row","user_img","src","alt","user_title","displayName","user_job","jobTitle"],"sources":["C:/Users/zhuikov/OneDrive - SOFTCOM/Desktop/web/2024/korportal/src/components/UserInfoModalWindow/UserInfoModalWindow.jsx"],"sourcesContent":["import { useEffect, useState } from 'react';\r\nimport ModalWidnow from '../UI/ModalWidnow/ModalWidnow';\r\nimport Loader from '../UI/Loader/Loader';\r\nimport s from './UserInfoModalWindow.module.css';\r\nimport { getUserById } from '../../api/graph';\r\nimport { useMsal } from '@azure/msal-react';\r\n\r\nconst UserInfoModalWindow = ({ userId, visibleStatus, closeModal }) => {\r\n\tconst { instance, accounts } = useMsal();\r\n\tlet [userData, setUserData] = useState(false);\r\n\tlet [userImg, setUserImg] = useState('');\r\n\tlet [isFetching, setIsFetching] = useState(false);\r\n\r\n\tfunction RequestUsersData() {\r\n\t\tsetIsFetching(true);\r\n\t\tinstance\r\n\t\t\t.acquireTokenSilent({\r\n\t\t\t\tscopes: ['User.Read.All'],\r\n\t\t\t\taccount: accounts[0],\r\n\t\t\t})\r\n\t\t\t.then((response) => {\r\n\t\t\t\tgetUserById(response.accessToken, userId)\r\n\t\t\t\t\t.then((response) => response.json())\r\n\t\t\t\t\t.then((result) => {\r\n\t\t\t\t\t\tsetIsFetching(false);\r\n\t\t\t\t\t\tsetUserData(result);\r\n\t\t\t\t\t\tconsole.log(result);\r\n\t\t\t\t\t})\r\n\t\t\t\t\t.catch((rerror) => {\r\n\t\t\t\t\t\tsetIsFetching(false);\r\n\t\t\t\t\t});\r\n\t\t\t});\r\n\r\n\t\tsetTimeout(() => {\r\n\t\t\tsetIsFetching(false);\r\n\t\t}, 12000);\r\n\t}\r\n\r\n\tfunction RequestProfilePhoto(id) {\r\n\t\treturn instance\r\n\t\t\t.acquireTokenSilent({\r\n\t\t\t\t...loginRequest,\r\n\t\t\t\taccount: accounts[0],\r\n\t\t\t})\r\n\t\t\t.then((response) => {\r\n\t\t\t\treturn getPhotoUser(response.accessToken, id)\r\n\t\t\t\t\t.then((response) => {\r\n\t\t\t\t\t\tif (response) {\r\n\t\t\t\t\t\t\treturn response.blob();\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\treturn '';\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t})\r\n\t\t\t\t\t.then((result) => {\r\n\t\t\t\t\t\tconst url = window.URL || window.webkitURL;\r\n\t\t\t\t\t\tconst blobUrl = url.createObjectURL(result);\r\n\r\n\t\t\t\t\t\tif (result.type === 'application/json') {\r\n\t\t\t\t\t\t\treturn '';\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tsetUserImg(blobUrl);\r\n\t\t\t\t\t})\r\n\t\t\t\t\t.catch((error) => console.log(error));\r\n\t\t\t});\r\n\t}\r\n\r\n\tuseEffect(() => {\r\n\t\tconsole.log(userId);\r\n\t\tRequestUsersData();\r\n\t}, [userId]);\r\n\r\n\treturn (\r\n\t\t<>\r\n\t\t\t{visibleStatus && (\r\n\t\t\t\t<ModalWidnow closeModal={closeModal}>\r\n\t\t\t\t\t{isFetching ? (\r\n\t\t\t\t\t\t<Loader />\r\n\t\t\t\t\t) : (\r\n\t\t\t\t\t\t<>\r\n\t\t\t\t\t\t\t{userData && (\r\n\t\t\t\t\t\t\t\t<div className={s.info_container}>\r\n\t\t\t\t\t\t\t\t\t<div className={s.user_row}>\r\n\t\t\t\t\t\t\t\t\t\t<img className={s.user_img} src={userImg} alt=\"\" />\r\n\t\t\t\t\t\t\t\t\t\t<div>\r\n\t\t\t\t\t\t\t\t\t\t\t<p className={s.user_title}>{userData.displayName}</p>\r\n\t\t\t\t\t\t\t\t\t\t\t<p className={s.user_job}>{userData.jobTitle}</p>\r\n\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t</>\r\n\t\t\t\t\t)}\r\n\t\t\t\t</ModalWidnow>\r\n\t\t\t)}\r\n\t\t</>\r\n\t);\r\n};\r\n\r\nexport default UserInfoModalWindow;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}