{"ast":null,"code":"var _jsxFileName = \"E:\\\\WEB\\\\korportal-master\\\\src\\\\components\\\\CommentsList\\\\CommentsList.jsx\",\n  _s = $RefreshSig$();\nimport { useEffect, useState } from 'react';\nimport s from './CommentsList.module.css';\nimport { useMsal } from '@azure/msal-react';\nimport { getPhotoUser } from '../../api/graph';\nimport { loginRequest } from '../../authConfig';\nimport UserInfoModalBtn from '../UserInfoModalBtn/UserInfoModalBtn';\nimport { useSelector } from 'react-redux';\nimport { userSelector } from '../../selectors/userSelectors';\nimport delteIcon from '../../assets/img/icons/delete-icon.svg';\nimport { deleteNewsPost } from '../../api/api';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst toDay = new Date().toJSON().slice(0, 10);\nconst CommentsList = ({\n  comment,\n  fullScreen,\n  uploadComments\n}) => {\n  _s();\n  const {\n    instance,\n    accounts\n  } = useMsal();\n  let user = useSelector(userSelector.userData);\n  let [commentsList, setCommentsList] = useState([]);\n  function RequestProfilePhoto(id) {\n    return instance.acquireTokenSilent({\n      ...loginRequest,\n      account: accounts[0]\n    }).then(response => {\n      return getPhotoUser(response.accessToken, id).then(response => {\n        if (response) {\n          return response.blob();\n        } else {\n          return '';\n        }\n      }).then(result => {\n        const url = window.URL || window.webkitURL;\n        const blobUrl = url.createObjectURL(result);\n        if (result.type === 'application/json') {\n          return '';\n        }\n        return blobUrl;\n      }).catch(error => console.log(error));\n    });\n  }\n  let findVisibleUsers = async array => {\n    let data = await Promise.all(array.map(async (item, index) => {\n      let imgUrl = await RequestProfilePhoto(item.usercode);\n      return {\n        ...item,\n        urlImg: imgUrl\n      };\n    }));\n    setCommentsList(data);\n    console.log(data);\n  };\n  useEffect(() => {\n    comment && findVisibleUsers(comment);\n  }, [comment]);\n  const onClickDeleteHandler = newsID => {\n    const deleteComment = async () => {\n      let result = await deleteNewsPost(newsID, user.id, 'comments');\n      if (result) uploadComments();\n    };\n    deleteComment();\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: `${s.commets_container} ${fullScreen && s.full_screen}`,\n    children: [/*#__PURE__*/_jsxDEV(\"p\", {\n      className: s.commets_h,\n      children: \"\\u041A\\u043E\\u043C\\u0435\\u043D\\u0442\\u0430\\u0440\\u0456:\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 73,\n      columnNumber: 4\n    }, this), /*#__PURE__*/_jsxDEV(\"ul\", {\n      className: s.commets_list,\n      children: commentsList && commentsList.map(({\n        autor,\n        post_date,\n        comment_txt,\n        urlImg,\n        usercode,\n        id\n      }, index) => {\n        return /*#__PURE__*/_jsxDEV(\"li\", {\n          className: `${s.commets_item}`,\n          children: [user && user.id === usercode && /*#__PURE__*/_jsxDEV(\"button\", {\n            className: s.delete_btn,\n            onClick: () => onClickDeleteHandler(id),\n            title: \"\\u0412\\u0438\\u0434\\u0430\\u043B\\u0438\\u0442\\u0438 \\u043A\\u043E\\u043C\\u0435\\u043D\\u0442\\u0430\\u0440\",\n            children: /*#__PURE__*/_jsxDEV(\"img\", {\n              src: delteIcon,\n              alt: \"\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 81,\n              columnNumber: 11\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 80,\n            columnNumber: 10\n          }, this), /*#__PURE__*/_jsxDEV(UserInfoModalBtn, {\n            userId: usercode,\n            children: /*#__PURE__*/_jsxDEV(\"div\", {\n              className: s.comment_user,\n              children: [/*#__PURE__*/_jsxDEV(\"img\", {\n                src: urlImg,\n                alt: \"\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 86,\n                columnNumber: 11\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                children: [/*#__PURE__*/_jsxDEV(\"p\", {\n                  className: s.commets_title,\n                  children: autor && autor\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 88,\n                  columnNumber: 12\n                }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                  className: s.commets_date,\n                  children: post_date && toDay === post_date.slice(0, 10) ? `Сьогодні ${post_date.slice(11, 16)}` : `${post_date.slice(8, 10)}-${post_date.slice(5, 7)}-${post_date.slice(0, 4)} ${post_date.slice(11, 16)}`\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 89,\n                  columnNumber: 12\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 87,\n                columnNumber: 11\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 85,\n              columnNumber: 10\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 84,\n            columnNumber: 9\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            className: s.commets_text,\n            children: comment_txt && comment_txt\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 97,\n            columnNumber: 9\n          }, this)]\n        }, `comment${index}`, true, {\n          fileName: _jsxFileName,\n          lineNumber: 78,\n          columnNumber: 8\n        }, this);\n      })\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 74,\n      columnNumber: 4\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 72,\n    columnNumber: 3\n  }, this);\n};\n_s(CommentsList, \"DqcH9uamYIto/7lZ3dT4em+moXU=\", false, function () {\n  return [useMsal, useSelector];\n});\n_c = CommentsList;\nexport default CommentsList;\nvar _c;\n$RefreshReg$(_c, \"CommentsList\");","map":{"version":3,"names":["useEffect","useState","s","useMsal","getPhotoUser","loginRequest","UserInfoModalBtn","useSelector","userSelector","delteIcon","deleteNewsPost","jsxDEV","_jsxDEV","toDay","Date","toJSON","slice","CommentsList","comment","fullScreen","uploadComments","_s","instance","accounts","user","userData","commentsList","setCommentsList","RequestProfilePhoto","id","acquireTokenSilent","account","then","response","accessToken","blob","result","url","window","URL","webkitURL","blobUrl","createObjectURL","type","catch","error","console","log","findVisibleUsers","array","data","Promise","all","map","item","index","imgUrl","usercode","urlImg","onClickDeleteHandler","newsID","deleteComment","className","commets_container","full_screen","children","commets_h","fileName","_jsxFileName","lineNumber","columnNumber","commets_list","autor","post_date","comment_txt","commets_item","delete_btn","onClick","title","src","alt","userId","comment_user","commets_title","commets_date","commets_text","_c","$RefreshReg$"],"sources":["E:/WEB/korportal-master/src/components/CommentsList/CommentsList.jsx"],"sourcesContent":["import { useEffect, useState } from 'react';\r\nimport s from './CommentsList.module.css';\r\nimport { useMsal } from '@azure/msal-react';\r\nimport { getPhotoUser } from '../../api/graph';\r\nimport { loginRequest } from '../../authConfig';\r\nimport UserInfoModalBtn from '../UserInfoModalBtn/UserInfoModalBtn';\r\nimport { useSelector } from 'react-redux';\r\nimport { userSelector } from '../../selectors/userSelectors';\r\nimport delteIcon from '../../assets/img/icons/delete-icon.svg';\r\nimport { deleteNewsPost } from '../../api/api';\r\n\r\nconst toDay = new Date().toJSON().slice(0, 10);\r\n\r\nconst CommentsList = ({ comment, fullScreen, uploadComments }) => {\r\n\tconst { instance, accounts } = useMsal();\r\n\tlet user = useSelector(userSelector.userData);\r\n\tlet [commentsList, setCommentsList] = useState([]);\r\n\r\n\tfunction RequestProfilePhoto(id) {\r\n\t\treturn instance\r\n\t\t\t.acquireTokenSilent({\r\n\t\t\t\t...loginRequest,\r\n\t\t\t\taccount: accounts[0],\r\n\t\t\t})\r\n\t\t\t.then((response) => {\r\n\t\t\t\treturn getPhotoUser(response.accessToken, id)\r\n\t\t\t\t\t.then((response) => {\r\n\t\t\t\t\t\tif (response) {\r\n\t\t\t\t\t\t\treturn response.blob();\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\treturn '';\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t})\r\n\t\t\t\t\t.then((result) => {\r\n\t\t\t\t\t\tconst url = window.URL || window.webkitURL;\r\n\t\t\t\t\t\tconst blobUrl = url.createObjectURL(result);\r\n\r\n\t\t\t\t\t\tif (result.type === 'application/json') {\r\n\t\t\t\t\t\t\treturn '';\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\treturn blobUrl;\r\n\t\t\t\t\t})\r\n\t\t\t\t\t.catch((error) => console.log(error));\r\n\t\t\t});\r\n\t}\r\n\r\n\tlet findVisibleUsers = async (array) => {\r\n\t\tlet data = await Promise.all(\r\n\t\t\tarray.map(async (item, index) => {\r\n\t\t\t\tlet imgUrl = await RequestProfilePhoto(item.usercode);\r\n\t\t\t\treturn { ...item, urlImg: imgUrl };\r\n\t\t\t})\r\n\t\t);\r\n\t\tsetCommentsList(data);\r\n\t\tconsole.log(data);\r\n\t};\r\n\r\n\tuseEffect(() => {\r\n\t\tcomment && findVisibleUsers(comment);\r\n\t}, [comment]);\r\n\r\n\tconst onClickDeleteHandler = (newsID) => {\r\n\t\tconst deleteComment = async () => {\r\n\t\t\tlet result = await deleteNewsPost(newsID, user.id, 'comments');\r\n\t\t\tif (result) uploadComments();\r\n\t\t};\r\n\t\tdeleteComment();\r\n\t};\r\n\r\n\treturn (\r\n\t\t<div className={`${s.commets_container} ${fullScreen && s.full_screen}`}>\r\n\t\t\t<p className={s.commets_h}>Коментарі:</p>\r\n\t\t\t<ul className={s.commets_list}>\r\n\t\t\t\t{commentsList &&\r\n\t\t\t\t\tcommentsList.map(({ autor, post_date, comment_txt, urlImg, usercode, id }, index) => {\r\n\t\t\t\t\t\treturn (\r\n\t\t\t\t\t\t\t<li key={`comment${index}`} className={`${s.commets_item}`}>\r\n\t\t\t\t\t\t\t\t{user && user.id === usercode && (\r\n\t\t\t\t\t\t\t\t\t<button className={s.delete_btn} onClick={() => onClickDeleteHandler(id)} title=\"Видалити коментар\">\r\n\t\t\t\t\t\t\t\t\t\t<img src={delteIcon} alt=\"\" />\r\n\t\t\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t\t<UserInfoModalBtn userId={usercode}>\r\n\t\t\t\t\t\t\t\t\t<div className={s.comment_user}>\r\n\t\t\t\t\t\t\t\t\t\t<img src={urlImg} alt=\"\" />\r\n\t\t\t\t\t\t\t\t\t\t<div>\r\n\t\t\t\t\t\t\t\t\t\t\t<p className={s.commets_title}>{autor && autor}</p>\r\n\t\t\t\t\t\t\t\t\t\t\t<p className={s.commets_date}>\r\n\t\t\t\t\t\t\t\t\t\t\t\t{post_date && toDay === post_date.slice(0, 10)\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t? `Сьогодні ${post_date.slice(11, 16)}`\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t: `${post_date.slice(8, 10)}-${post_date.slice(5, 7)}-${post_date.slice(0, 4)} ${post_date.slice(11, 16)}`}\r\n\t\t\t\t\t\t\t\t\t\t\t</p>\r\n\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t</UserInfoModalBtn>\r\n\t\t\t\t\t\t\t\t<p className={s.commets_text}>{comment_txt && comment_txt}</p>\r\n\t\t\t\t\t\t\t</li>\r\n\t\t\t\t\t\t);\r\n\t\t\t\t\t})}\r\n\t\t\t</ul>\r\n\t\t</div>\r\n\t);\r\n};\r\n\r\nexport default CommentsList;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}