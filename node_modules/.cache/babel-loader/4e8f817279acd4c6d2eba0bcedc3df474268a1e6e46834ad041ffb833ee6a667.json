{"ast":null,"code":"import s from'./AdminPostSection.module.css';import{useEffect,useRef,useState}from'react';import smileIcon from'../../../assets/img/icons/smile-icon.svg';import EmojiList from'../../../components/EmojiList/EmojiList';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const FormTextBlock=_ref=>{let{text,setText,validationErrors}=_ref;let[visibleStatus2,setVisibleStatus2]=useState(false);let[selectionStart,setSelectionStart]=useState(null);let[selectionEnd,setSelectionEnd]=useState(null);const editorRef=useRef(null);const swiftInsert=(original,index,insert)=>original.substring(0,index)+insert+original.substring(index);// Встановлюємо початковий HTML тільки один раз\nuseEffect(()=>{if(editorRef.current&&text&&!editorRef.current.innerHTML){editorRef.current.innerHTML=text;}},[]);const handleButtons=(e,caseValue)=>{e.preventDefault();editorRef.current.focus();// Зберігає фокус для вставки\nswitch(caseValue){case'bold':document.execCommand('bold');break;case'italic':document.execCommand('italic');break;case'underline':document.execCommand('underline');break;case'link':const url=prompt('Введіть посилання:');if(url){document.execCommand('createLink',false,url);}break;default:break;}setText(editorRef.current.innerHTML);// зберігаємо HTML після команди\n};const handleKeyDown=e=>{if(e.key==='Enter'){e.preventDefault();const selection=window.getSelection();if(!selection||!selection.rangeCount)return;const range=selection.getRangeAt(0);range.deleteContents();const br=document.createElement('br');range.insertNode(br);// Створюємо текстовий вузол після <br>\nconst textNode=document.createTextNode('\\u200B');// zero-width space\nbr.parentNode.insertBefore(textNode,br.nextSibling);// Перемістити курсор у текстовий вузол після <br>\nconst newRange=document.createRange();newRange.setStart(textNode,1);newRange.setEnd(textNode,1);selection.removeAllRanges();selection.addRange(newRange);}};const changeTextHandler=()=>{setText(editorRef.current.innerHTML);};return/*#__PURE__*/_jsxs(\"div\",{className:s.post_item,children:[/*#__PURE__*/_jsxs(\"p\",{children:[\"\\u0422\\u0435\\u043A\\u0441\\u0442 \\u043F\\u043E\\u0434\\u0456\\u0457:\",/*#__PURE__*/_jsx(\"span\",{style:{fontSize:'20px',color:'red'},title:\"\\u041E\\u0431\\u043E\\u0432`\\u044F\\u0437\\u043A\\u043E\\u0432\\u0435\",children:\"*\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:s.row_btns,children:[/*#__PURE__*/_jsx(\"button\",{onClick:e=>handleButtons(e,'bold'),children:/*#__PURE__*/_jsx(\"b\",{children:\"b\"})}),/*#__PURE__*/_jsx(\"button\",{onClick:e=>handleButtons(e,'italic'),children:/*#__PURE__*/_jsx(\"i\",{children:\"i\"})}),/*#__PURE__*/_jsx(\"button\",{onClick:e=>handleButtons(e,'underline'),children:/*#__PURE__*/_jsx(\"u\",{children:\"u\"})}),/*#__PURE__*/_jsx(\"button\",{onClick:e=>handleButtons(e,'link'),children:\"link\"})]}),/*#__PURE__*/_jsx(\"div\",{ref:editorRef,className:\"editor\",contentEditable:true,onInput:changeTextHandler,onKeyDown:handleKeyDown,suppressContentEditableWarning:true}),/*#__PURE__*/_jsx(\"button\",{title:\"\\u0421\\u043C\\u0430\\u0439\\u043B\\u0438\\u043A\\u0438\",onClick:e=>{e.preventDefault();setVisibleStatus2(status=>!status);},className:s.smile_button,children:/*#__PURE__*/_jsx(\"img\",{src:smileIcon,alt:\"\"})}),/*#__PURE__*/_jsx(EmojiList,{visibleStatus:visibleStatus2,setSmile:val=>{editorRef.current.focus();document.execCommand('insertHTML',false,val);setText(editorRef.current.innerHTML);}})]});};export default FormTextBlock;","map":{"version":3,"names":["s","useEffect","useRef","useState","smileIcon","EmojiList","jsx","_jsx","jsxs","_jsxs","FormTextBlock","_ref","text","setText","validationErrors","visibleStatus2","setVisibleStatus2","selectionStart","setSelectionStart","selectionEnd","setSelectionEnd","editorRef","swiftInsert","original","index","insert","substring","current","innerHTML","handleButtons","e","caseValue","preventDefault","focus","document","execCommand","url","prompt","handleKeyDown","key","selection","window","getSelection","rangeCount","range","getRangeAt","deleteContents","br","createElement","insertNode","textNode","createTextNode","parentNode","insertBefore","nextSibling","newRange","createRange","setStart","setEnd","removeAllRanges","addRange","changeTextHandler","className","post_item","children","style","fontSize","color","title","row_btns","onClick","ref","contentEditable","onInput","onKeyDown","suppressContentEditableWarning","status","smile_button","src","alt","visibleStatus","setSmile","val"],"sources":["C:/Users/zhuikov/OneDrive - SOFTCOM/Desktop/web/2024/korportal/src/pages/AdminAddChangeNewsPage/AdminPostSection/FormTextBlock.jsx"],"sourcesContent":["import s from './AdminPostSection.module.css';\r\nimport { useEffect, useRef, useState } from 'react';\r\nimport smileIcon from '../../../assets/img/icons/smile-icon.svg';\r\nimport EmojiList from '../../../components/EmojiList/EmojiList';\r\n\r\nconst FormTextBlock = ({ text, setText, validationErrors }) => {\r\n\tlet [visibleStatus2, setVisibleStatus2] = useState(false);\r\n\tlet [selectionStart, setSelectionStart] = useState(null);\r\n\tlet [selectionEnd, setSelectionEnd] = useState(null);\r\n\r\n\tconst editorRef = useRef(null);\r\n\r\n\tconst swiftInsert = (original, index, insert) => original.substring(0, index) + insert + original.substring(index);\r\n\r\n\t// Встановлюємо початковий HTML тільки один раз\r\n\tuseEffect(() => {\r\n\t\tif (editorRef.current && text && !editorRef.current.innerHTML) {\r\n\t\t\teditorRef.current.innerHTML = text;\r\n\t\t}\r\n\t}, []);\r\n\r\n\tconst handleButtons = (e, caseValue) => {\r\n\t\te.preventDefault();\r\n\t\teditorRef.current.focus(); // Зберігає фокус для вставки\r\n\r\n\t\tswitch (caseValue) {\r\n\t\t\tcase 'bold':\r\n\t\t\t\tdocument.execCommand('bold');\r\n\t\t\t\tbreak;\r\n\t\t\tcase 'italic':\r\n\t\t\t\tdocument.execCommand('italic');\r\n\t\t\t\tbreak;\r\n\t\t\tcase 'underline':\r\n\t\t\t\tdocument.execCommand('underline');\r\n\t\t\t\tbreak;\r\n\t\t\tcase 'link':\r\n\t\t\t\tconst url = prompt('Введіть посилання:');\r\n\t\t\t\tif (url) {\r\n\t\t\t\t\tdocument.execCommand('createLink', false, url);\r\n\t\t\t\t}\r\n\t\t\t\tbreak;\r\n\t\t\tdefault:\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\t\tsetText(editorRef.current.innerHTML); // зберігаємо HTML після команди\r\n\t};\r\n\r\n\tconst handleKeyDown = (e) => {\r\n\t\tif (e.key === 'Enter') {\r\n\t\t\te.preventDefault();\r\n\r\n\t\t\tconst selection = window.getSelection();\r\n\t\t\tif (!selection || !selection.rangeCount) return;\r\n\r\n\t\t\tconst range = selection.getRangeAt(0);\r\n\t\t\trange.deleteContents();\r\n\r\n\t\t\tconst br = document.createElement('br');\r\n\t\t\trange.insertNode(br);\r\n\r\n\t\t\t// Створюємо текстовий вузол після <br>\r\n\t\t\tconst textNode = document.createTextNode('\\u200B'); // zero-width space\r\n\t\t\tbr.parentNode.insertBefore(textNode, br.nextSibling);\r\n\r\n\t\t\t// Перемістити курсор у текстовий вузол після <br>\r\n\t\t\tconst newRange = document.createRange();\r\n\t\t\tnewRange.setStart(textNode, 1);\r\n\t\t\tnewRange.setEnd(textNode, 1);\r\n\r\n\t\t\tselection.removeAllRanges();\r\n\t\t\tselection.addRange(newRange);\r\n\t\t}\r\n\t};\r\n\r\n\tconst changeTextHandler = () => {\r\n\t\tsetText(editorRef.current.innerHTML);\r\n\t};\r\n\r\n\treturn (\r\n\t\t<div className={s.post_item}>\r\n\t\t\t<p>\r\n\t\t\t\tТекст події:\r\n\t\t\t\t<span style={{ fontSize: '20px', color: 'red' }} title=\"Обов`язкове\">\r\n\t\t\t\t\t*\r\n\t\t\t\t</span>\r\n\t\t\t</p>\r\n\t\t\t{/* <div className={s.row_btns}>\r\n\t\t\t\t<button onClick={boldBtnOnClickHandler}>\r\n\t\t\t\t\t<b>b</b>\r\n\t\t\t\t</button>\r\n\t\t\t\t<button onClick={boldBtnOnClickHandler}>\r\n\t\t\t\t\t<i>i</i>\r\n\t\t\t\t</button>\r\n\t\t\t\t<button onClick={boldBtnOnClickHandler}>\r\n\t\t\t\t\t<span style={{ textDecoration: 'underline' }}>u</span>\r\n\t\t\t\t</button>\r\n\t\t\t\t<button onClick={boldBtnOnClickHandler}>\r\n\t\t\t\t\t<span>link</span>\r\n\t\t\t\t</button>\r\n\t\t\t</div> */}\r\n\t\t\t{/* <textarea\r\n\t\t\t\tvalue={text}\r\n\t\t\t\tonSelect={(e) => {\r\n\t\t\t\t\tsetSelectionStart(e.target.selectionStart);\r\n\t\t\t\t\tsetSelectionEnd(e.target.selectionEnd);\r\n\t\t\t\t}}\r\n\t\t\t\tonChange={(e) => {\r\n\t\t\t\t\tsetText(e.target.value);\r\n\t\t\t\t}}\r\n\t\t\t\tplaceholder=\"Текст події\"\r\n\t\t\t\tclassName={`${s.text} ${validationErrors.text ? s.validated : ''}`}></textarea> */}\r\n\t\t\t<div className={s.row_btns}>\r\n\t\t\t\t<button onClick={(e) => handleButtons(e, 'bold')}>\r\n\t\t\t\t\t<b>b</b>\r\n\t\t\t\t</button>\r\n\t\t\t\t<button onClick={(e) => handleButtons(e, 'italic')}>\r\n\t\t\t\t\t<i>i</i>\r\n\t\t\t\t</button>\r\n\t\t\t\t<button onClick={(e) => handleButtons(e, 'underline')}>\r\n\t\t\t\t\t<u>u</u>\r\n\t\t\t\t</button>\r\n\t\t\t\t<button onClick={(e) => handleButtons(e, 'link')}>link</button>\r\n\t\t\t</div>\r\n\r\n\t\t\t<div\r\n\t\t\t\tref={editorRef}\r\n\t\t\t\tclassName=\"editor\"\r\n\t\t\t\tcontentEditable\r\n\t\t\t\tonInput={changeTextHandler}\r\n\t\t\t\tonKeyDown={handleKeyDown}\r\n\t\t\t\tsuppressContentEditableWarning={true}\r\n\t\t\t/>\r\n\t\t\t<button\r\n\t\t\t\ttitle=\"Смайлики\"\r\n\t\t\t\tonClick={(e) => {\r\n\t\t\t\t\te.preventDefault();\r\n\t\t\t\t\tsetVisibleStatus2((status) => !status);\r\n\t\t\t\t}}\r\n\t\t\t\tclassName={s.smile_button}>\r\n\t\t\t\t<img src={smileIcon} alt=\"\" />\r\n\t\t\t</button>\r\n\t\t\t<EmojiList\r\n\t\t\t\tvisibleStatus={visibleStatus2}\r\n\t\t\t\tsetSmile={(val) => {\r\n\t\t\t\t\teditorRef.current.focus();\r\n\t\t\t\t\tdocument.execCommand('insertHTML', false, val);\r\n\t\t\t\t\tsetText(editorRef.current.innerHTML);\r\n\t\t\t\t}}\r\n\t\t\t/>\r\n\t\t</div>\r\n\t);\r\n};\r\n\r\nexport default FormTextBlock;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}