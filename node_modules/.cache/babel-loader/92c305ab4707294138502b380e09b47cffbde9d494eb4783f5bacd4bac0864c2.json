{"ast":null,"code":"import{useEffect,useState}from'react';import DeleteButton from'../../../components/UI/DeleteButton/DeleteButton';import s from'./GalleryFilesFormSection.module.css';import{deleteGalleryCatalogsFiles,uploadFileInGallery}from'../../../api/api';import Loader from'../../../components/UI/Loader/Loader';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const GalleryFilesFormSection=_ref=>{let{files,Id}=_ref;let[filesList,setFilesList]=useState([]);let[fetchingFiles,setFetchingFiles]=useState([]);useEffect(()=>{files&&setFilesList(files);},[files]);const onChangeInputFilesHandler=e=>{let filesListInput=e.target.files;if(filesListInput.length>0){console.log(filesListInput);let objectFetchingFile={fetching:true,url:'',id:null};for(let index=0;index<filesListInput.length;index++){setFetchingFiles(list=>[...list,objectFetchingFile]);}let indexFile=0;async function processArray(array){for(const item of array){let imgInArray=[item];let result=await uploadFileInGallery(Id,imgInArray);console.log(result);// await setFetchingFiles((listFiles) => {\n// \tlet currentArray = [...listFiles];\n// \tcurrentArray[indexFile].fetching = false;\n// \treturn currentArray;\n// });\nindexFile++;}console.log('Done!');}processArray(filesListInput);}};const onClickDeleteHandler=id=>{deleteGalleryCatalogsFiles(id,'files');};return/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsxs(\"div\",{className:s.files_list,children:[/*#__PURE__*/_jsxs(\"div\",{className:`${s.files_item} ${s.files_add_btn}`,children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"upload-files\"}),/*#__PURE__*/_jsx(\"input\",{id:\"upload-files\",type:\"file\",multiple:true,onChange:onChangeInputFilesHandler})]}),fetchingFiles.map(file=>/*#__PURE__*/_jsx(\"div\",{className:`${s.files_item} ${s.files_fetching}`,children:file.fetching&&/*#__PURE__*/_jsx(Loader,{})})),files&&files.length>0&&files.map(file=>/*#__PURE__*/_jsxs(\"div\",{className:s.files_item,children:[/*#__PURE__*/_jsx(\"img\",{className:s.file_img,src:`${file.url}`,alt:\"\"}),/*#__PURE__*/_jsx(DeleteButton,{onClickHandler:()=>onClickDeleteHandler(file.id)})]}))]})});};export default GalleryFilesFormSection;","map":{"version":3,"names":["useEffect","useState","DeleteButton","s","deleteGalleryCatalogsFiles","uploadFileInGallery","Loader","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","GalleryFilesFormSection","_ref","files","Id","filesList","setFilesList","fetchingFiles","setFetchingFiles","onChangeInputFilesHandler","e","filesListInput","target","length","console","log","objectFetchingFile","fetching","url","id","index","list","indexFile","processArray","array","item","imgInArray","result","onClickDeleteHandler","children","className","files_list","files_item","files_add_btn","htmlFor","type","multiple","onChange","map","file","files_fetching","file_img","src","alt","onClickHandler"],"sources":["C:/Users/zhuikov/OneDrive - SOFTCOM/Desktop/web/2024/korportal/src/pages/AdminAddChangeGalleryPage/GalleryFilesFormSection/GalleryFilesFormSection.jsx"],"sourcesContent":["import { useEffect, useState } from 'react';\r\nimport DeleteButton from '../../../components/UI/DeleteButton/DeleteButton';\r\nimport s from './GalleryFilesFormSection.module.css';\r\nimport { deleteGalleryCatalogsFiles, uploadFileInGallery } from '../../../api/api';\r\nimport Loader from '../../../components/UI/Loader/Loader';\r\n\r\nconst GalleryFilesFormSection = ({ files, Id }) => {\r\n\tlet [filesList, setFilesList] = useState([]);\r\n\tlet [fetchingFiles, setFetchingFiles] = useState([]);\r\n\r\n\tuseEffect(() => {\r\n\t\tfiles && setFilesList(files);\r\n\t}, [files]);\r\n\r\n\tconst onChangeInputFilesHandler = (e) => {\r\n\t\tlet filesListInput = e.target.files;\r\n\r\n\t\tif (filesListInput.length > 0) {\r\n\t\t\tconsole.log(filesListInput);\r\n\r\n\t\t\tlet objectFetchingFile = { fetching: true, url: '', id: null };\r\n\r\n\t\t\tfor (let index = 0; index < filesListInput.length; index++) {\r\n\t\t\t\tsetFetchingFiles((list) => [...list, objectFetchingFile]);\r\n\t\t\t}\r\n\r\n\t\t\tlet indexFile = 0;\r\n\t\t\tasync function processArray(array) {\r\n\t\t\t\tfor (const item of array) {\r\n\t\t\t\t\tlet imgInArray = [item];\r\n\r\n\t\t\t\t\tlet result = await uploadFileInGallery(Id, imgInArray);\r\n\r\n\t\t\t\t\tconsole.log(result);\r\n\r\n\t\t\t\t\t// await setFetchingFiles((listFiles) => {\r\n\t\t\t\t\t// \tlet currentArray = [...listFiles];\r\n\t\t\t\t\t// \tcurrentArray[indexFile].fetching = false;\r\n\t\t\t\t\t// \treturn currentArray;\r\n\t\t\t\t\t// });\r\n\r\n\t\t\t\t\tindexFile++;\r\n\t\t\t\t}\r\n\t\t\t\tconsole.log('Done!');\r\n\t\t\t}\r\n\t\t\tprocessArray(filesListInput);\r\n\t\t}\r\n\t};\r\n\r\n\tconst onClickDeleteHandler = (id) => {\r\n\t\tdeleteGalleryCatalogsFiles(id, 'files');\r\n\t};\r\n\r\n\treturn (\r\n\t\t<>\r\n\t\t\t<div className={s.files_list}>\r\n\t\t\t\t<div className={`${s.files_item} ${s.files_add_btn}`}>\r\n\t\t\t\t\t<label htmlFor=\"upload-files\"></label>\r\n\t\t\t\t\t<input id=\"upload-files\" type=\"file\" multiple onChange={onChangeInputFilesHandler}></input>\r\n\t\t\t\t</div>\r\n\r\n\t\t\t\t{fetchingFiles.map((file) => (\r\n\t\t\t\t\t<div className={`${s.files_item} ${s.files_fetching}`}>{file.fetching && <Loader />}</div>\r\n\t\t\t\t))}\r\n\r\n\t\t\t\t{files &&\r\n\t\t\t\t\tfiles.length > 0 &&\r\n\t\t\t\t\tfiles.map((file) => (\r\n\t\t\t\t\t\t<div className={s.files_item}>\r\n\t\t\t\t\t\t\t<img className={s.file_img} src={`${file.url}`} alt=\"\" />\r\n\t\t\t\t\t\t\t<DeleteButton onClickHandler={() => onClickDeleteHandler(file.id)} />\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t))}\r\n\t\t\t</div>\r\n\t\t</>\r\n\t);\r\n};\r\n\r\nexport default GalleryFilesFormSection;\r\n"],"mappings":"AAAA,OAASA,SAAS,CAAEC,QAAQ,KAAQ,OAAO,CAC3C,MAAO,CAAAC,YAAY,KAAM,kDAAkD,CAC3E,MAAO,CAAAC,CAAC,KAAM,sCAAsC,CACpD,OAASC,0BAA0B,CAAEC,mBAAmB,KAAQ,kBAAkB,CAClF,MAAO,CAAAC,MAAM,KAAM,sCAAsC,CAAC,OAAAC,GAAA,IAAAC,IAAA,CAAAC,IAAA,IAAAC,KAAA,CAAAC,QAAA,IAAAC,SAAA,yBAE1D,KAAM,CAAAC,uBAAuB,CAAGC,IAAA,EAAmB,IAAlB,CAAEC,KAAK,CAAEC,EAAG,CAAC,CAAAF,IAAA,CAC7C,GAAI,CAACG,SAAS,CAAEC,YAAY,CAAC,CAAGjB,QAAQ,CAAC,EAAE,CAAC,CAC5C,GAAI,CAACkB,aAAa,CAAEC,gBAAgB,CAAC,CAAGnB,QAAQ,CAAC,EAAE,CAAC,CAEpDD,SAAS,CAAC,IAAM,CACfe,KAAK,EAAIG,YAAY,CAACH,KAAK,CAAC,CAC7B,CAAC,CAAE,CAACA,KAAK,CAAC,CAAC,CAEX,KAAM,CAAAM,yBAAyB,CAAIC,CAAC,EAAK,CACxC,GAAI,CAAAC,cAAc,CAAGD,CAAC,CAACE,MAAM,CAACT,KAAK,CAEnC,GAAIQ,cAAc,CAACE,MAAM,CAAG,CAAC,CAAE,CAC9BC,OAAO,CAACC,GAAG,CAACJ,cAAc,CAAC,CAE3B,GAAI,CAAAK,kBAAkB,CAAG,CAAEC,QAAQ,CAAE,IAAI,CAAEC,GAAG,CAAE,EAAE,CAAEC,EAAE,CAAE,IAAK,CAAC,CAE9D,IAAK,GAAI,CAAAC,KAAK,CAAG,CAAC,CAAEA,KAAK,CAAGT,cAAc,CAACE,MAAM,CAAEO,KAAK,EAAE,CAAE,CAC3DZ,gBAAgB,CAAEa,IAAI,EAAK,CAAC,GAAGA,IAAI,CAAEL,kBAAkB,CAAC,CAAC,CAC1D,CAEA,GAAI,CAAAM,SAAS,CAAG,CAAC,CACjB,cAAe,CAAAC,YAAYA,CAACC,KAAK,CAAE,CAClC,IAAK,KAAM,CAAAC,IAAI,GAAI,CAAAD,KAAK,CAAE,CACzB,GAAI,CAAAE,UAAU,CAAG,CAACD,IAAI,CAAC,CAEvB,GAAI,CAAAE,MAAM,CAAG,KAAM,CAAAlC,mBAAmB,CAACW,EAAE,CAAEsB,UAAU,CAAC,CAEtDZ,OAAO,CAACC,GAAG,CAACY,MAAM,CAAC,CAEnB;AACA;AACA;AACA;AACA;AAEAL,SAAS,EAAE,CACZ,CACAR,OAAO,CAACC,GAAG,CAAC,OAAO,CAAC,CACrB,CACAQ,YAAY,CAACZ,cAAc,CAAC,CAC7B,CACD,CAAC,CAED,KAAM,CAAAiB,oBAAoB,CAAIT,EAAE,EAAK,CACpC3B,0BAA0B,CAAC2B,EAAE,CAAE,OAAO,CAAC,CACxC,CAAC,CAED,mBACCvB,IAAA,CAAAI,SAAA,EAAA6B,QAAA,cACC/B,KAAA,QAAKgC,SAAS,CAAEvC,CAAC,CAACwC,UAAW,CAAAF,QAAA,eAC5B/B,KAAA,QAAKgC,SAAS,CAAE,GAAGvC,CAAC,CAACyC,UAAU,IAAIzC,CAAC,CAAC0C,aAAa,EAAG,CAAAJ,QAAA,eACpDjC,IAAA,UAAOsC,OAAO,CAAC,cAAc,CAAQ,CAAC,cACtCtC,IAAA,UAAOuB,EAAE,CAAC,cAAc,CAACgB,IAAI,CAAC,MAAM,CAACC,QAAQ,MAACC,QAAQ,CAAE5B,yBAA0B,CAAQ,CAAC,EACvF,CAAC,CAELF,aAAa,CAAC+B,GAAG,CAAEC,IAAI,eACvB3C,IAAA,QAAKkC,SAAS,CAAE,GAAGvC,CAAC,CAACyC,UAAU,IAAIzC,CAAC,CAACiD,cAAc,EAAG,CAAAX,QAAA,CAAEU,IAAI,CAACtB,QAAQ,eAAIrB,IAAA,CAACF,MAAM,GAAE,CAAC,CAAM,CACzF,CAAC,CAEDS,KAAK,EACLA,KAAK,CAACU,MAAM,CAAG,CAAC,EAChBV,KAAK,CAACmC,GAAG,CAAEC,IAAI,eACdzC,KAAA,QAAKgC,SAAS,CAAEvC,CAAC,CAACyC,UAAW,CAAAH,QAAA,eAC5BjC,IAAA,QAAKkC,SAAS,CAAEvC,CAAC,CAACkD,QAAS,CAACC,GAAG,CAAE,GAAGH,IAAI,CAACrB,GAAG,EAAG,CAACyB,GAAG,CAAC,EAAE,CAAE,CAAC,cACzD/C,IAAA,CAACN,YAAY,EAACsD,cAAc,CAAEA,CAAA,GAAMhB,oBAAoB,CAACW,IAAI,CAACpB,EAAE,CAAE,CAAE,CAAC,EACjE,CACL,CAAC,EACC,CAAC,CACL,CAAC,CAEL,CAAC,CAED,cAAe,CAAAlB,uBAAuB","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}