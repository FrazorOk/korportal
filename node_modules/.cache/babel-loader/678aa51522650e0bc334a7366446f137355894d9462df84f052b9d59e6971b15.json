{"ast":null,"code":"import{useEffect,useState}from'react';import s from'./CommentsList.module.css';import{useMsal}from'@azure/msal-react';import{getPhotoUser}from'../../api/graph';import{loginRequest}from'../../authConfig';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const toDay=new Date().toJSON().slice(0,10);const CommentsList=_ref=>{let{comment,fullScreen}=_ref;const{instance,accounts}=useMsal();let[commentsList,setCommentsList]=useState([]);function RequestProfilePhoto(id){return instance.acquireTokenSilent({...loginRequest,account:accounts[0]}).then(response=>{return getPhotoUser(response.accessToken,id).then(response=>{if(response){return response.blob();}else{return'';}}).then(result=>{const url=window.URL||window.webkitURL;const blobUrl=url.createObjectURL(result);if(result.type==='application/json'){return'';}return blobUrl;}).catch(error=>console.log(error));});}let findVisibleUsers=async array=>{let data=await Promise.all(array.map(async(item,index)=>{let imgUrl=await RequestProfilePhoto(item.usercode);return{...item,urlImg:imgUrl};}));setCommentsList(data);console.log(data);};useEffect(()=>{console.log(comment);comment&&findVisibleUsers(comment);},[comment]);return/*#__PURE__*/_jsxs(\"div\",{className:`${s.commets_container} ${fullScreen&&s.full_screen}`,children:[/*#__PURE__*/_jsx(\"p\",{className:s.commets_h,children:\"\\u041A\\u043E\\u043C\\u0435\\u043D\\u0442\\u0430\\u0440\\u0456:\"}),/*#__PURE__*/_jsx(\"ul\",{className:s.commets_list,children:commentsList&&commentsList.map((_ref2,index)=>{let{autor,post_date,comment_txt,urlImg}=_ref2;return/*#__PURE__*/_jsxs(\"li\",{className:`${s.commets_item}`,children:[/*#__PURE__*/_jsx(UserInfoModalBtn,{userId:user.usercode,children:/*#__PURE__*/_jsxs(\"div\",{className:s.comment_user,children:[/*#__PURE__*/_jsx(\"img\",{src:urlImg,alt:\"\"}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"p\",{className:s.commets_title,children:autor&&autor}),/*#__PURE__*/_jsx(\"p\",{className:s.commets_date,children:post_date&&toDay===post_date.slice(0,10)?`Сьогодні ${post_date.slice(11,16)}`:`${post_date.slice(8,10)}-${post_date.slice(5,7)}-${post_date.slice(0,4)} ${post_date.slice(11,16)}`})]})]})}),/*#__PURE__*/_jsx(\"p\",{className:s.commets_text,children:comment_txt&&comment_txt})]},`comment${index}`);})})]});};export default CommentsList;","map":{"version":3,"names":["useEffect","useState","s","useMsal","getPhotoUser","loginRequest","jsx","_jsx","jsxs","_jsxs","toDay","Date","toJSON","slice","CommentsList","_ref","comment","fullScreen","instance","accounts","commentsList","setCommentsList","RequestProfilePhoto","id","acquireTokenSilent","account","then","response","accessToken","blob","result","url","window","URL","webkitURL","blobUrl","createObjectURL","type","catch","error","console","log","findVisibleUsers","array","data","Promise","all","map","item","index","imgUrl","usercode","urlImg","className","commets_container","full_screen","children","commets_h","commets_list","_ref2","autor","post_date","comment_txt","commets_item","UserInfoModalBtn","userId","user","comment_user","src","alt","commets_title","commets_date","commets_text"],"sources":["E:/web/web/2024/korportal/src/components/CommentsList/CommentsList.jsx"],"sourcesContent":["import { useEffect, useState } from 'react';\r\nimport s from './CommentsList.module.css';\r\nimport { useMsal } from '@azure/msal-react';\r\nimport { getPhotoUser } from '../../api/graph';\r\nimport { loginRequest } from '../../authConfig';\r\n\r\nconst toDay = new Date().toJSON().slice(0, 10);\r\n\r\nconst CommentsList = ({ comment, fullScreen }) => {\r\n\tconst { instance, accounts } = useMsal();\r\n\tlet [commentsList, setCommentsList] = useState([]);\r\n\r\n\tfunction RequestProfilePhoto(id) {\r\n\t\treturn instance\r\n\t\t\t.acquireTokenSilent({\r\n\t\t\t\t...loginRequest,\r\n\t\t\t\taccount: accounts[0],\r\n\t\t\t})\r\n\t\t\t.then((response) => {\r\n\t\t\t\treturn getPhotoUser(response.accessToken, id)\r\n\t\t\t\t\t.then((response) => {\r\n\t\t\t\t\t\tif (response) {\r\n\t\t\t\t\t\t\treturn response.blob();\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\treturn '';\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t})\r\n\t\t\t\t\t.then((result) => {\r\n\t\t\t\t\t\tconst url = window.URL || window.webkitURL;\r\n\t\t\t\t\t\tconst blobUrl = url.createObjectURL(result);\r\n\r\n\t\t\t\t\t\tif (result.type === 'application/json') {\r\n\t\t\t\t\t\t\treturn '';\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\treturn blobUrl;\r\n\t\t\t\t\t})\r\n\t\t\t\t\t.catch((error) => console.log(error));\r\n\t\t\t});\r\n\t}\r\n\r\n\tlet findVisibleUsers = async (array) => {\r\n\t\tlet data = await Promise.all(\r\n\t\t\tarray.map(async (item, index) => {\r\n\t\t\t\tlet imgUrl = await RequestProfilePhoto(item.usercode);\r\n\t\t\t\treturn { ...item, urlImg: imgUrl };\r\n\t\t\t})\r\n\t\t);\r\n\t\tsetCommentsList(data);\r\n\t\tconsole.log(data);\r\n\t};\r\n\r\n\tuseEffect(() => {\r\n\t\tconsole.log(comment);\r\n\t\tcomment && findVisibleUsers(comment);\r\n\t}, [comment]);\r\n\r\n\treturn (\r\n\t\t<div className={`${s.commets_container} ${fullScreen && s.full_screen}`}>\r\n\t\t\t<p className={s.commets_h}>Коментарі:</p>\r\n\t\t\t<ul className={s.commets_list}>\r\n\t\t\t\t{commentsList &&\r\n\t\t\t\t\tcommentsList.map(({ autor, post_date, comment_txt, urlImg }, index) => {\r\n\t\t\t\t\t\treturn (\r\n\t\t\t\t\t\t\t<li key={`comment${index}`} className={`${s.commets_item}`}>\r\n\t\t\t\t\t\t\t\t<UserInfoModalBtn userId={user.usercode}>\r\n\t\t\t\t\t\t\t\t\t<div className={s.comment_user}>\r\n\t\t\t\t\t\t\t\t\t\t<img src={urlImg} alt=\"\" />\r\n\t\t\t\t\t\t\t\t\t\t<div>\r\n\t\t\t\t\t\t\t\t\t\t\t<p className={s.commets_title}>{autor && autor}</p>\r\n\t\t\t\t\t\t\t\t\t\t\t<p className={s.commets_date}>\r\n\t\t\t\t\t\t\t\t\t\t\t\t{post_date && toDay === post_date.slice(0, 10)\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t? `Сьогодні ${post_date.slice(11, 16)}`\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t: `${post_date.slice(8, 10)}-${post_date.slice(5, 7)}-${post_date.slice(0, 4)} ${post_date.slice(11, 16)}`}\r\n\t\t\t\t\t\t\t\t\t\t\t</p>\r\n\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t</UserInfoModalBtn>\r\n\t\t\t\t\t\t\t\t<p className={s.commets_text}>{comment_txt && comment_txt}</p>\r\n\t\t\t\t\t\t\t</li>\r\n\t\t\t\t\t\t);\r\n\t\t\t\t\t})}\r\n\t\t\t</ul>\r\n\t\t</div>\r\n\t);\r\n};\r\n\r\nexport default CommentsList;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}