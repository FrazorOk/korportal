{"ast":null,"code":"import{memo,useEffect,useState}from'react';import s from'./NewsList.module.css';import NewsItem from'../NewsItem/NewsItem';import circleArrowIcon from'../../assets/img/icons/circle-arrow-icon.svg';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const toDay=new Date().toJSON().slice(0,10);const NewsList=_ref=>{let{data,setTags,filterParams,setTodayPosts}=_ref;let[news,setNews]=useState([]);let[visibleNews,setVisibleNews]=useState([]);let[paginationNews,setPaginationNews]=useState([]);let[stepPagination,setStepPagination]=useState(1);const getTodayPostsLength=()=>{return news.filter((el,index)=>index<data.length-1&&el.pub_date.slice(0,10)===toDay);};const getUniqueTags=arr=>{if(arr){let concatedArray=[];arr.forEach((element,index)=>{if(index!==arr.length-1&&element.tags){concatedArray=[...concatedArray,...element.tags];}});let uniqueTags=[...new Set(concatedArray)];return uniqueTags;}};const getFilteredNews=()=>{if(filterParams.tags){let filteredArray=news.filter((el,index)=>{if(index<data.length-1&&el.tags){let statusTags=false;el.tags.forEach(item=>{if(filterParams.params===item){statusTags=true;}else{statusTags=false;}});return statusTags;}});return filteredArray=[...filteredArray,null];}else{if(filterParams.params==='Усі'){return news;}if(filterParams.params==='Сьогодні'){let filteredArray=getTodayPostsLength();return filteredArray=[...filteredArray,null];}if(filterParams.params==='Популярне'){let currentArray=news.map((el,index)=>{if(index!==news.length-1){return el;}});currentArray.pop();function compare(a,b){let aReactions=0;let aComments=0;let bReactions=0;let bComments=0;if(a.reaction){aReactions=a.reaction.length;}if(a.comment){aComments=a.comment.length;}if(b.reaction){bReactions=b.reaction.length;}if(b.comment){bComments=b.comment.length;}if(aReactions*1+aComments*1<bReactions*1+bComments*1){return 1;}if(aReactions*1+aComments*1>bReactions*1+bComments*1){return-1;}return 0;}let filteredArray=currentArray.sort(compare);return filteredArray=[...filteredArray,null];}}};const getPaginationNews=()=>{const indexStep=2;if(stepPagination*indexStep>visibleNews.length-1){setPaginationNews(arr=>[...visibleNews.slice(0,visibleNews.length)]);}else{setPaginationNews(arr=>[...visibleNews.slice(0,stepPagination*indexStep)]);}};useEffect(()=>{setNews(data);setTags(getUniqueTags(data));},[data]);useEffect(()=>{setTodayPosts(getTodayPostsLength().length);setVisibleNews(getFilteredNews());setStepPagination(1);},[news,filterParams]);useEffect(()=>{getPaginationNews();},[visibleNews,stepPagination]);const addMoreNewsHandler=()=>{setStepPagination(count=>count+1);};return/*#__PURE__*/_jsxs(\"div\",{className:s.news_container,children:[/*#__PURE__*/_jsx(\"div\",{className:s.news,children:paginationNews?paginationNews.map((item,index)=>{if(item&&index<visibleNews.length-1&&paginationNews.length>0){return/*#__PURE__*/_jsx(NewsItem,{item:item,filterParams:filterParams},item.id);}}):/*#__PURE__*/_jsx(\"p\",{children:\"\\u041D\\u0456\\u0447\\u043E\\u0433\\u043E \\u043D\\u0435 \\u0437\\u043D\\u0430\\u0439\\u0434\\u0435\\u043D\\u043E\"})}),news&&visibleNews.length>paginationNews.length+1&&/*#__PURE__*/_jsx(\"div\",{className:s.add_more_btn_container,children:/*#__PURE__*/_jsxs(\"button\",{onClick:addMoreNewsHandler,className:s.add_more_btn,children:[/*#__PURE__*/_jsx(\"img\",{src:circleArrowIcon,alt:\"\"}),/*#__PURE__*/_jsx(\"p\",{children:\"\\u0417\\u0430\\u0432\\u0430\\u043D\\u0442\\u0430\\u0436\\u0438\\u0442\\u0438 \\u0449\\u0435\"})]})})]});};export default/*#__PURE__*/memo(NewsList);","map":{"version":3,"names":["memo","useEffect","useState","s","NewsItem","circleArrowIcon","jsx","_jsx","jsxs","_jsxs","toDay","Date","toJSON","slice","NewsList","_ref","data","setTags","filterParams","setTodayPosts","news","setNews","visibleNews","setVisibleNews","paginationNews","setPaginationNews","stepPagination","setStepPagination","getTodayPostsLength","filter","el","index","length","pub_date","getUniqueTags","arr","concatedArray","forEach","element","tags","uniqueTags","Set","getFilteredNews","filteredArray","statusTags","item","params","currentArray","map","pop","compare","a","b","aReactions","aComments","bReactions","bComments","reaction","comment","sort","getPaginationNews","indexStep","addMoreNewsHandler","count","className","news_container","children","id","add_more_btn_container","onClick","add_more_btn","src","alt"],"sources":["E:/web/web/2024/korportal/src/components/NewsList/NewsList.jsx"],"sourcesContent":["import { memo, useEffect, useState } from 'react';\r\nimport s from './NewsList.module.css';\r\nimport NewsItem from '../NewsItem/NewsItem';\r\nimport circleArrowIcon from '../../assets/img/icons/circle-arrow-icon.svg';\r\n\r\nconst toDay = new Date().toJSON().slice(0, 10);\r\n\r\nconst NewsList = ({ data, setTags, filterParams, setTodayPosts }) => {\r\n\tlet [news, setNews] = useState([]);\r\n\tlet [visibleNews, setVisibleNews] = useState([]);\r\n\r\n\tlet [paginationNews, setPaginationNews] = useState([]);\r\n\tlet [stepPagination, setStepPagination] = useState(1);\r\n\r\n\tconst getTodayPostsLength = () => {\r\n\t\treturn news.filter((el, index) => index < data.length - 1 && el.pub_date.slice(0, 10) === toDay);\r\n\t};\r\n\tconst getUniqueTags = (arr) => {\r\n\t\tif (arr) {\r\n\t\t\tlet concatedArray = [];\r\n\r\n\t\t\tarr.forEach((element, index) => {\r\n\t\t\t\tif (index !== arr.length - 1 && element.tags) {\r\n\t\t\t\t\tconcatedArray = [...concatedArray, ...element.tags];\r\n\t\t\t\t}\r\n\t\t\t});\r\n\r\n\t\t\tlet uniqueTags = [...new Set(concatedArray)];\r\n\r\n\t\t\treturn uniqueTags;\r\n\t\t}\r\n\t};\r\n\tconst getFilteredNews = () => {\r\n\t\tif (filterParams.tags) {\r\n\t\t\tlet filteredArray = news.filter((el, index) => {\r\n\t\t\t\tif (index < data.length - 1 && el.tags) {\r\n\t\t\t\t\tlet statusTags = false;\r\n\r\n\t\t\t\t\tel.tags.forEach((item) => {\r\n\t\t\t\t\t\tif (filterParams.params === item) {\r\n\t\t\t\t\t\t\tstatusTags = true;\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tstatusTags = false;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\r\n\t\t\t\t\treturn statusTags;\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\treturn (filteredArray = [...filteredArray, null]);\r\n\t\t} else {\r\n\t\t\tif (filterParams.params === 'Усі') {\r\n\t\t\t\treturn news;\r\n\t\t\t}\r\n\t\t\tif (filterParams.params === 'Сьогодні') {\r\n\t\t\t\tlet filteredArray = getTodayPostsLength();\r\n\t\t\t\treturn (filteredArray = [...filteredArray, null]);\r\n\t\t\t}\r\n\t\t\tif (filterParams.params === 'Популярне') {\r\n\t\t\t\tlet currentArray = news.map((el, index) => {\r\n\t\t\t\t\tif (index !== news.length - 1) {\r\n\t\t\t\t\t\treturn el;\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t\tcurrentArray.pop();\r\n\r\n\t\t\t\tfunction compare(a, b) {\r\n\t\t\t\t\tlet aReactions = 0;\r\n\t\t\t\t\tlet aComments = 0;\r\n\t\t\t\t\tlet bReactions = 0;\r\n\t\t\t\t\tlet bComments = 0;\r\n\r\n\t\t\t\t\tif (a.reaction) {\r\n\t\t\t\t\t\taReactions = a.reaction.length;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (a.comment) {\r\n\t\t\t\t\t\taComments = a.comment.length;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (b.reaction) {\r\n\t\t\t\t\t\tbReactions = b.reaction.length;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (b.comment) {\r\n\t\t\t\t\t\tbComments = b.comment.length;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif (aReactions * 1 + aComments * 1 < bReactions * 1 + bComments * 1) {\r\n\t\t\t\t\t\treturn 1;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (aReactions * 1 + aComments * 1 > bReactions * 1 + bComments * 1) {\r\n\t\t\t\t\t\treturn -1;\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn 0;\r\n\t\t\t\t}\r\n\t\t\t\tlet filteredArray = currentArray.sort(compare);\r\n\r\n\t\t\t\treturn (filteredArray = [...filteredArray, null]);\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n\tconst getPaginationNews = () => {\r\n\t\tconst indexStep = 2;\r\n\t\tif (stepPagination * indexStep > visibleNews.length - 1) {\r\n\t\t\tsetPaginationNews((arr) => [...visibleNews.slice(0, visibleNews.length)]);\r\n\t\t} else {\r\n\t\t\tsetPaginationNews((arr) => [...visibleNews.slice(0, stepPagination * indexStep)]);\r\n\t\t}\r\n\t};\r\n\r\n\tuseEffect(() => {\r\n\t\tsetNews(data);\r\n\t\tsetTags(getUniqueTags(data));\r\n\t}, [data]);\r\n\tuseEffect(() => {\r\n\t\tsetTodayPosts(getTodayPostsLength().length);\r\n\t\tsetVisibleNews(getFilteredNews());\r\n\t\tsetStepPagination(1);\r\n\t}, [news, filterParams]);\r\n\tuseEffect(() => {\r\n\t\tgetPaginationNews();\r\n\t}, [visibleNews, stepPagination]);\r\n\r\n\tconst addMoreNewsHandler = () => {\r\n\t\tsetStepPagination((count) => count + 1);\r\n\t};\r\n\r\n\treturn (\r\n\t\t<div className={s.news_container}>\r\n\t\t\t<div className={s.news}>\r\n\t\t\t\t{paginationNews ? (\r\n\t\t\t\t\tpaginationNews.map((item, index) => {\r\n\t\t\t\t\t\tif (item && index < visibleNews.length - 1 && paginationNews.length > 0) {\r\n\t\t\t\t\t\t\treturn <NewsItem item={item} key={item.id} filterParams={filterParams} />;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t})\r\n\t\t\t\t) : (\r\n\t\t\t\t\t<p>Нічого не знайдено</p>\r\n\t\t\t\t)}\r\n\t\t\t</div>\r\n\t\t\t{news && visibleNews.length > paginationNews.length + 1 && (\r\n\t\t\t\t<div className={s.add_more_btn_container}>\r\n\t\t\t\t\t<button onClick={addMoreNewsHandler} className={s.add_more_btn}>\r\n\t\t\t\t\t\t<img src={circleArrowIcon} alt=\"\" />\r\n\t\t\t\t\t\t<p>Завантажити ще</p>\r\n\t\t\t\t\t</button>\r\n\t\t\t\t</div>\r\n\t\t\t)}\r\n\t\t</div>\r\n\t);\r\n};\r\n\r\nexport default memo(NewsList);\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}