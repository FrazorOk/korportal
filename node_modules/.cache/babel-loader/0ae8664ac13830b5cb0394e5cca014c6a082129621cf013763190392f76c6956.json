{"ast":null,"code":"import{useEffect,useReducer,useState}from'react';import s from'./Header.module.css';import{useMsal}from'@azure/msal-react';import{callMe,callPhoto,getAdminGroup,getAdminMembers,getGroups,getStructureCompany}from'../../api/graph';import{loginRequest}from'../../authConfig';import settingIcon from'../../assets/img/icons/settings-icon.svg';import searchIcon from'../../assets/img/icons/search-icon.svg';import logo from'../../assets/img/Frame 40.png';import{NavLink}from'react-router-dom';import{sendUserProfile}from'../../api/api';import{useDispatch}from'react-redux';import{setAdmin,setUser}from'../../store/userSlice';import{fetchSeenNews}from'../../store/thunks';import Cookies from'js-cookie';import NotificationModule from'../NotificationModule/NotificationModule';import{msalInstance}from'../..';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const Header=_ref=>{let{toggleMobileMode,mobileMode}=_ref;const dispatch=useDispatch();const{instance,accounts}=useMsal();let[urlImg,setUrlImg]=useState(null);let[graphData,setGraphData]=useState(null);function RequestProfilePhoto(){instance.acquireTokenSilent({...loginRequest,account:accounts[0]}).then(response=>{callPhoto(response.accessToken).then(response=>response.blob()).then(result=>{const url=window.URL||window.webkitURL;const blobUrl=url.createObjectURL(result);setUrlImg(blobUrl);});});}async function RequestProfileData(){const accounts1=msalInstance.getAllAccounts();if(!accounts1||accounts1.length===0){alert('No user account found');}try{let response=await msalInstance.acquireTokenSilent({...loginRequest,account:accounts1[0]});let result=await callMe(response.accessToken);setGraphData(result);}catch(error){msalInstance.acquireTokenRedirect({...loginRequest,account:accounts1[0]});}}function RequestAdminsGroupData(){instance.acquireTokenSilent({...loginRequest,account:accounts[0]}).then(response=>{getAdminMembers(response.accessToken).then(response=>{return response.json();}).then(result=>{let adminStatus=result.value.find(_ref2=>{let{id}=_ref2;return id===graphData.id;});if(adminStatus){dispatch(setAdmin('isAdmin'));}else{dispatch(setAdmin('notAdmin'));}return result;});});}// function RequestAdminsGroupName() {\n// \tinstance\n// \t\t.acquireTokenSilent({\n// \t\t\t...loginRequest,\n// \t\t\taccount: accounts[0],\n// \t\t})\n// \t\t.then((response) => {\n// \t\t\tgetAdminGroup(response.accessToken)\n// \t\t\t\t.then((response) => {\n// \t\t\t\t\tconsole.log(response);\n// \t\t\t\t\treturn response.json();\n// \t\t\t\t})\n// \t\t\t\t.then((result) => {\n// \t\t\t\t\tconsole.log(result);\n// \t\t\t\t});\n// \t\t});\n// }\nuseEffect(()=>{RequestProfileData();RequestProfilePhoto();},[]);useEffect(()=>{if(accounts.length>0&&graphData){dispatch(setUser(graphData));dispatch(fetchSeenNews(graphData.id));sendUserProfile(graphData);RequestAdminsGroupData();}},[graphData]);return/*#__PURE__*/_jsx(\"header\",{children:/*#__PURE__*/_jsxs(\"div\",{className:`content-container ${s.header} `,children:[/*#__PURE__*/_jsx(\"div\",{className:s.header_column,children:/*#__PURE__*/_jsx(NavLink,{to:\"/\",className:s.header_logo,children:/*#__PURE__*/_jsx(\"img\",{src:logo,alt:\"\"})})}),/*#__PURE__*/_jsxs(\"div\",{className:s.header_column,children:[/*#__PURE__*/_jsx(\"div\",{className:s.header_btns,children:/*#__PURE__*/_jsx(NotificationModule,{toggleMobileMode:toggleMobileMode,mobileMode:mobileMode})}),/*#__PURE__*/_jsxs(\"div\",{className:s.header_profile,children:[urlImg&&/*#__PURE__*/_jsx(\"img\",{src:`${urlImg}`,alt:\"\"}),graphData&&/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"p\",{children:graphData.displayName}),/*#__PURE__*/_jsx(\"p\",{children:graphData.jobTitle})]})]}),/*#__PURE__*/_jsx(\"div\",{className:`${s.header_mobile__button}`,children:/*#__PURE__*/_jsx(\"button\",{className:`${mobileMode&&s.visible}`,onClick:e=>toggleMobileMode(button=>!button),children:/*#__PURE__*/_jsx(\"span\",{})})})]})]})});};export default Header;","map":{"version":3,"names":["useEffect","useReducer","useState","s","useMsal","callMe","callPhoto","getAdminGroup","getAdminMembers","getGroups","getStructureCompany","loginRequest","settingIcon","searchIcon","logo","NavLink","sendUserProfile","useDispatch","setAdmin","setUser","fetchSeenNews","Cookies","NotificationModule","msalInstance","jsx","_jsx","jsxs","_jsxs","Header","_ref","toggleMobileMode","mobileMode","dispatch","instance","accounts","urlImg","setUrlImg","graphData","setGraphData","RequestProfilePhoto","acquireTokenSilent","account","then","response","accessToken","blob","result","url","window","URL","webkitURL","blobUrl","createObjectURL","RequestProfileData","accounts1","getAllAccounts","length","alert","error","acquireTokenRedirect","RequestAdminsGroupData","json","adminStatus","value","find","_ref2","id","children","className","header","header_column","to","header_logo","src","alt","header_btns","header_profile","displayName","jobTitle","header_mobile__button","visible","onClick","e","button"],"sources":["C:/Users/Dmytro/Downloads/korportal-master/korportal-master/src/components/Header/Header.jsx"],"sourcesContent":["import { useEffect, useReducer, useState } from 'react';\nimport s from './Header.module.css';\nimport { useMsal } from '@azure/msal-react';\nimport { callMe, callPhoto, getAdminGroup, getAdminMembers, getGroups, getStructureCompany } from '../../api/graph';\nimport { loginRequest } from '../../authConfig';\nimport settingIcon from '../../assets/img/icons/settings-icon.svg';\nimport searchIcon from '../../assets/img/icons/search-icon.svg';\nimport logo from '../../assets/img/Frame 40.png';\nimport { NavLink } from 'react-router-dom';\nimport { sendUserProfile } from '../../api/api';\nimport { useDispatch } from 'react-redux';\nimport { setAdmin, setUser } from '../../store/userSlice';\nimport { fetchSeenNews } from '../../store/thunks';\nimport Cookies from 'js-cookie';\nimport NotificationModule from '../NotificationModule/NotificationModule';\nimport { msalInstance } from '../..';\n\nconst Header = ({ toggleMobileMode, mobileMode }) => {\n\tconst dispatch = useDispatch();\n\tconst { instance, accounts } = useMsal();\n\tlet [urlImg, setUrlImg] = useState(null);\n\tlet [graphData, setGraphData] = useState(null);\n\n\tfunction RequestProfilePhoto() {\n\t\tinstance\n\t\t\t.acquireTokenSilent({\n\t\t\t\t...loginRequest,\n\t\t\t\taccount: accounts[0],\n\t\t\t})\n\t\t\t.then((response) => {\n\t\t\t\tcallPhoto(response.accessToken)\n\t\t\t\t\t.then((response) => response.blob())\n\t\t\t\t\t.then((result) => {\n\t\t\t\t\t\tconst url = window.URL || window.webkitURL;\n\t\t\t\t\t\tconst blobUrl = url.createObjectURL(result);\n\t\t\t\t\t\tsetUrlImg(blobUrl);\n\t\t\t\t\t});\n\t\t\t});\n\t}\n\n\tasync function RequestProfileData() {\n\t\tconst accounts1 = msalInstance.getAllAccounts();\n\t\tif (!accounts1 || accounts1.length === 0) {\n\t\t\talert('No user account found');\n\t\t}\n\t\ttry {\n\t\t\tlet response = await msalInstance.acquireTokenSilent({\n\t\t\t\t...loginRequest,\n\t\t\t\taccount: accounts1[0],\n\t\t\t});\n\t\t\tlet result = await callMe(response.accessToken);\n\t\t\tsetGraphData(result);\n\t\t} catch (error) {\n\t\t\tmsalInstance.acquireTokenRedirect({\n\t\t\t\t...loginRequest,\n\t\t\t\taccount: accounts1[0],\n\t\t\t});\n\t\t}\n\t}\n\n\tfunction RequestAdminsGroupData() {\n\t\tinstance\n\t\t\t.acquireTokenSilent({\n\t\t\t\t...loginRequest,\n\t\t\t\taccount: accounts[0],\n\t\t\t})\n\t\t\t.then((response) => {\n\t\t\t\tgetAdminMembers(response.accessToken)\n\t\t\t\t\t.then((response) => {\n\t\t\t\t\t\treturn response.json();\n\t\t\t\t\t})\n\t\t\t\t\t.then((result) => {\n\t\t\t\t\t\tlet adminStatus = result.value.find(({ id }) => id === graphData.id);\n\t\t\t\t\t\tif (adminStatus) {\n\t\t\t\t\t\t\tdispatch(setAdmin('isAdmin'));\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tdispatch(setAdmin('notAdmin'));\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn result;\n\t\t\t\t\t});\n\t\t\t});\n\t}\n\n\t// function RequestAdminsGroupName() {\n\t// \tinstance\n\t// \t\t.acquireTokenSilent({\n\t// \t\t\t...loginRequest,\n\t// \t\t\taccount: accounts[0],\n\t// \t\t})\n\t// \t\t.then((response) => {\n\t// \t\t\tgetAdminGroup(response.accessToken)\n\t// \t\t\t\t.then((response) => {\n\t// \t\t\t\t\tconsole.log(response);\n\t// \t\t\t\t\treturn response.json();\n\t// \t\t\t\t})\n\t// \t\t\t\t.then((result) => {\n\t// \t\t\t\t\tconsole.log(result);\n\t// \t\t\t\t});\n\t// \t\t});\n\t// }\n\n\tuseEffect(() => {\n\t\tRequestProfileData();\n\t\tRequestProfilePhoto();\n\t}, []);\n\n\tuseEffect(() => {\n\t\tif (accounts.length > 0 && graphData) {\n\t\t\tdispatch(setUser(graphData));\n\t\t\tdispatch(fetchSeenNews(graphData.id));\n\t\t\tsendUserProfile(graphData);\n\t\t\tRequestAdminsGroupData();\n\t\t}\n\t}, [graphData]);\n\n\treturn (\n\t\t<header>\n\t\t\t<div className={`content-container ${s.header} `}>\n\t\t\t\t<div className={s.header_column}>\n\t\t\t\t\t<NavLink to=\"/\" className={s.header_logo}>\n\t\t\t\t\t\t<img src={logo} alt=\"\" />\n\t\t\t\t\t</NavLink>\n\n\t\t\t\t\t{/* Панель ПОШУКУ */}\n\t\t\t\t\t{/* <div className={s.header_search}>\n\t\t\t\t\t\t<button>\n\t\t\t\t\t\t\t<img src={searchIcon} alt=\"bell icon\" />\n\t\t\t\t\t\t</button>\n\t\t\t\t\t\t<input type=\"text\" placeholder=\"Пошук тут...\" />\n\t\t\t\t\t</div> */}\n\t\t\t\t</div>\n\t\t\t\t<div className={s.header_column}>\n\t\t\t\t\t{/* КНОПКА НАЛАШТУВАННЯ */}\n\t\t\t\t\t<div className={s.header_btns}>\n\t\t\t\t\t\t{/*\t<a href=\"\">\n\t\t\t\t\t\t\t<img src={settingIcon} alt=\"setting icon\" />\n\t\t\t\t\t\t</a>*/}\n\t\t\t\t\t\t<NotificationModule toggleMobileMode={toggleMobileMode} mobileMode={mobileMode} />\n\t\t\t\t\t</div>\n\t\t\t\t\t<div className={s.header_profile}>\n\t\t\t\t\t\t{urlImg && <img src={`${urlImg}`} alt=\"\" />}\n\t\t\t\t\t\t{graphData && (\n\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t<p>{graphData.displayName}</p>\n\t\t\t\t\t\t\t\t<p>{graphData.jobTitle}</p>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t)}\n\t\t\t\t\t</div>\n\t\t\t\t\t<div className={`${s.header_mobile__button}`}>\n\t\t\t\t\t\t<button className={`${mobileMode && s.visible}`} onClick={(e) => toggleMobileMode((button) => !button)}>\n\t\t\t\t\t\t\t<span></span>\n\t\t\t\t\t\t</button>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</header>\n\t);\n};\n\nexport default Header;\n"],"mappings":"AAAA,OAASA,SAAS,CAAEC,UAAU,CAAEC,QAAQ,KAAQ,OAAO,CACvD,MAAO,CAAAC,CAAC,KAAM,qBAAqB,CACnC,OAASC,OAAO,KAAQ,mBAAmB,CAC3C,OAASC,MAAM,CAAEC,SAAS,CAAEC,aAAa,CAAEC,eAAe,CAAEC,SAAS,CAAEC,mBAAmB,KAAQ,iBAAiB,CACnH,OAASC,YAAY,KAAQ,kBAAkB,CAC/C,MAAO,CAAAC,WAAW,KAAM,0CAA0C,CAClE,MAAO,CAAAC,UAAU,KAAM,wCAAwC,CAC/D,MAAO,CAAAC,IAAI,KAAM,+BAA+B,CAChD,OAASC,OAAO,KAAQ,kBAAkB,CAC1C,OAASC,eAAe,KAAQ,eAAe,CAC/C,OAASC,WAAW,KAAQ,aAAa,CACzC,OAASC,QAAQ,CAAEC,OAAO,KAAQ,uBAAuB,CACzD,OAASC,aAAa,KAAQ,oBAAoB,CAClD,MAAO,CAAAC,OAAO,KAAM,WAAW,CAC/B,MAAO,CAAAC,kBAAkB,KAAM,0CAA0C,CACzE,OAASC,YAAY,KAAQ,OAAO,CAAC,OAAAC,GAAA,IAAAC,IAAA,CAAAC,IAAA,IAAAC,KAAA,yBAErC,KAAM,CAAAC,MAAM,CAAGC,IAAA,EAAsC,IAArC,CAAEC,gBAAgB,CAAEC,UAAW,CAAC,CAAAF,IAAA,CAC/C,KAAM,CAAAG,QAAQ,CAAGf,WAAW,CAAC,CAAC,CAC9B,KAAM,CAAEgB,QAAQ,CAAEC,QAAS,CAAC,CAAG9B,OAAO,CAAC,CAAC,CACxC,GAAI,CAAC+B,MAAM,CAAEC,SAAS,CAAC,CAAGlC,QAAQ,CAAC,IAAI,CAAC,CACxC,GAAI,CAACmC,SAAS,CAAEC,YAAY,CAAC,CAAGpC,QAAQ,CAAC,IAAI,CAAC,CAE9C,QAAS,CAAAqC,mBAAmBA,CAAA,CAAG,CAC9BN,QAAQ,CACNO,kBAAkB,CAAC,CACnB,GAAG7B,YAAY,CACf8B,OAAO,CAAEP,QAAQ,CAAC,CAAC,CACpB,CAAC,CAAC,CACDQ,IAAI,CAAEC,QAAQ,EAAK,CACnBrC,SAAS,CAACqC,QAAQ,CAACC,WAAW,CAAC,CAC7BF,IAAI,CAAEC,QAAQ,EAAKA,QAAQ,CAACE,IAAI,CAAC,CAAC,CAAC,CACnCH,IAAI,CAAEI,MAAM,EAAK,CACjB,KAAM,CAAAC,GAAG,CAAGC,MAAM,CAACC,GAAG,EAAID,MAAM,CAACE,SAAS,CAC1C,KAAM,CAAAC,OAAO,CAAGJ,GAAG,CAACK,eAAe,CAACN,MAAM,CAAC,CAC3CV,SAAS,CAACe,OAAO,CAAC,CACnB,CAAC,CAAC,CACJ,CAAC,CAAC,CACJ,CAEA,cAAe,CAAAE,kBAAkBA,CAAA,CAAG,CACnC,KAAM,CAAAC,SAAS,CAAG/B,YAAY,CAACgC,cAAc,CAAC,CAAC,CAC/C,GAAI,CAACD,SAAS,EAAIA,SAAS,CAACE,MAAM,GAAK,CAAC,CAAE,CACzCC,KAAK,CAAC,uBAAuB,CAAC,CAC/B,CACA,GAAI,CACH,GAAI,CAAAd,QAAQ,CAAG,KAAM,CAAApB,YAAY,CAACiB,kBAAkB,CAAC,CACpD,GAAG7B,YAAY,CACf8B,OAAO,CAAEa,SAAS,CAAC,CAAC,CACrB,CAAC,CAAC,CACF,GAAI,CAAAR,MAAM,CAAG,KAAM,CAAAzC,MAAM,CAACsC,QAAQ,CAACC,WAAW,CAAC,CAC/CN,YAAY,CAACQ,MAAM,CAAC,CACrB,CAAE,MAAOY,KAAK,CAAE,CACfnC,YAAY,CAACoC,oBAAoB,CAAC,CACjC,GAAGhD,YAAY,CACf8B,OAAO,CAAEa,SAAS,CAAC,CAAC,CACrB,CAAC,CAAC,CACH,CACD,CAEA,QAAS,CAAAM,sBAAsBA,CAAA,CAAG,CACjC3B,QAAQ,CACNO,kBAAkB,CAAC,CACnB,GAAG7B,YAAY,CACf8B,OAAO,CAAEP,QAAQ,CAAC,CAAC,CACpB,CAAC,CAAC,CACDQ,IAAI,CAAEC,QAAQ,EAAK,CACnBnC,eAAe,CAACmC,QAAQ,CAACC,WAAW,CAAC,CACnCF,IAAI,CAAEC,QAAQ,EAAK,CACnB,MAAO,CAAAA,QAAQ,CAACkB,IAAI,CAAC,CAAC,CACvB,CAAC,CAAC,CACDnB,IAAI,CAAEI,MAAM,EAAK,CACjB,GAAI,CAAAgB,WAAW,CAAGhB,MAAM,CAACiB,KAAK,CAACC,IAAI,CAACC,KAAA,MAAC,CAAEC,EAAG,CAAC,CAAAD,KAAA,OAAK,CAAAC,EAAE,GAAK7B,SAAS,CAAC6B,EAAE,GAAC,CACpE,GAAIJ,WAAW,CAAE,CAChB9B,QAAQ,CAACd,QAAQ,CAAC,SAAS,CAAC,CAAC,CAC9B,CAAC,IAAM,CACNc,QAAQ,CAACd,QAAQ,CAAC,UAAU,CAAC,CAAC,CAC/B,CACA,MAAO,CAAA4B,MAAM,CACd,CAAC,CAAC,CACJ,CAAC,CAAC,CACJ,CAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA9C,SAAS,CAAC,IAAM,CACfqD,kBAAkB,CAAC,CAAC,CACpBd,mBAAmB,CAAC,CAAC,CACtB,CAAC,CAAE,EAAE,CAAC,CAENvC,SAAS,CAAC,IAAM,CACf,GAAIkC,QAAQ,CAACsB,MAAM,CAAG,CAAC,EAAInB,SAAS,CAAE,CACrCL,QAAQ,CAACb,OAAO,CAACkB,SAAS,CAAC,CAAC,CAC5BL,QAAQ,CAACZ,aAAa,CAACiB,SAAS,CAAC6B,EAAE,CAAC,CAAC,CACrClD,eAAe,CAACqB,SAAS,CAAC,CAC1BuB,sBAAsB,CAAC,CAAC,CACzB,CACD,CAAC,CAAE,CAACvB,SAAS,CAAC,CAAC,CAEf,mBACCZ,IAAA,WAAA0C,QAAA,cACCxC,KAAA,QAAKyC,SAAS,CAAE,qBAAqBjE,CAAC,CAACkE,MAAM,GAAI,CAAAF,QAAA,eAChD1C,IAAA,QAAK2C,SAAS,CAAEjE,CAAC,CAACmE,aAAc,CAAAH,QAAA,cAC/B1C,IAAA,CAACV,OAAO,EAACwD,EAAE,CAAC,GAAG,CAACH,SAAS,CAAEjE,CAAC,CAACqE,WAAY,CAAAL,QAAA,cACxC1C,IAAA,QAAKgD,GAAG,CAAE3D,IAAK,CAAC4D,GAAG,CAAC,EAAE,CAAE,CAAC,CACjB,CAAC,CASN,CAAC,cACN/C,KAAA,QAAKyC,SAAS,CAAEjE,CAAC,CAACmE,aAAc,CAAAH,QAAA,eAE/B1C,IAAA,QAAK2C,SAAS,CAAEjE,CAAC,CAACwE,WAAY,CAAAR,QAAA,cAI7B1C,IAAA,CAACH,kBAAkB,EAACQ,gBAAgB,CAAEA,gBAAiB,CAACC,UAAU,CAAEA,UAAW,CAAE,CAAC,CAC9E,CAAC,cACNJ,KAAA,QAAKyC,SAAS,CAAEjE,CAAC,CAACyE,cAAe,CAAAT,QAAA,EAC/BhC,MAAM,eAAIV,IAAA,QAAKgD,GAAG,CAAE,GAAGtC,MAAM,EAAG,CAACuC,GAAG,CAAC,EAAE,CAAE,CAAC,CAC1CrC,SAAS,eACTV,KAAA,QAAAwC,QAAA,eACC1C,IAAA,MAAA0C,QAAA,CAAI9B,SAAS,CAACwC,WAAW,CAAI,CAAC,cAC9BpD,IAAA,MAAA0C,QAAA,CAAI9B,SAAS,CAACyC,QAAQ,CAAI,CAAC,EACvB,CACL,EACG,CAAC,cACNrD,IAAA,QAAK2C,SAAS,CAAE,GAAGjE,CAAC,CAAC4E,qBAAqB,EAAG,CAAAZ,QAAA,cAC5C1C,IAAA,WAAQ2C,SAAS,CAAE,GAAGrC,UAAU,EAAI5B,CAAC,CAAC6E,OAAO,EAAG,CAACC,OAAO,CAAGC,CAAC,EAAKpD,gBAAgB,CAAEqD,MAAM,EAAK,CAACA,MAAM,CAAE,CAAAhB,QAAA,cACtG1C,IAAA,UAAY,CAAC,CACN,CAAC,CACL,CAAC,EACF,CAAC,EACF,CAAC,CACC,CAAC,CAEX,CAAC,CAED,cAAe,CAAAG,MAAM","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}