{"ast":null,"code":"import{memo,useEffect,useState}from'react';import s from'./VivoChatSection.module.css';import NewsList from'../NewsListTest/NewsList';import{getNews}from'../../api/api';import NewsFilter from'../NewsFilterTest/NewsFilter';import arrowLinkIcon from'../../assets/img/icons/redirect-icon.svg';import{Link,useSearchParams}from'react-router-dom';import{useSelector}from'react-redux';import{userSelector}from'../../selectors/userSelectors';import Loader from'../UI/Loader/Loader';import{getNewsList}from'../../api/apiNews';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const VivoChatSection=_ref=>{let{ref1,adminStatus,title,fullScreen}=_ref;let[data,setData]=useState([]);let[tags,setTags]=useState([]);let[filterParams,setFilterParams]=useState({params:'Усі',tags:false});let[todayPosts,setTodayPosts]=useState(0);let[noSeenPotsLength,setNoSeenPotsLength]=useState(0);let[isFirstLoad,setFirstLoad]=useState(false);let[isFetching,setFetching]=useState(false);let userSeenNews=useSelector(userSelector.userSeenNews);const[searchParams,setSearchParams]=useSearchParams();let user=useSelector(userSelector.userData);useEffect(()=>{let getDataParams={userID:user.id,fromNumber:0,limitNumber:20,filterType:'Усі',all:0,categoryID:1};getNewsList(getDataParams);console.log(getDataParams);setFetching(true);getNews(setData).then(result=>{console.log(result);result&&setFetching(false);}).catch(error=>{setFetching(false);console.log(error);});setTimeout(()=>{isFetching&&setFetching(false);},10000);let interval=setInterval(()=>{getNews(setData);},300000);return()=>{clearInterval(interval);};},[user]);useEffect(()=>{let filterParam=searchParams.get('filter');if(!isFirstLoad&&filterParam&&filterParam==='noviews'&&data&&data.length>0&&userSeenNews){setFirstLoad(true);setFilterParams({params:'Не переглянуті',tags:false});}},[data,searchParams,userSeenNews]);return/*#__PURE__*/_jsxs(\"div\",{ref:ref1,className:`${s.chat} section-container ${fullScreen&&s.full_screen}`,children:[title&&/*#__PURE__*/_jsxs(Link,{className:\"title_link\",title:\"\\u041F\\u0435\\u0440\\u0435\\u0439\\u0442\\u0438\",to:'feed-news',children:[/*#__PURE__*/_jsx(\"h3\",{children:\"\\u0421\\u0442\\u0440\\u0456\\u0447\\u043A\\u0430 \\u043E\\u0441\\u0442\\u0430\\u043D\\u043D\\u0456\\u0445 \\u043D\\u043E\\u0432\\u0438\\u043D\"}),/*#__PURE__*/_jsx(\"img\",{src:arrowLinkIcon,alt:\"\"})]}),/*#__PURE__*/_jsx(NewsFilter,{noSeenPotsLength:noSeenPotsLength,tags:tags,setFilterParams:setFilterParams,todayPosts:todayPosts,setData:setData,fullScreen:fullScreen}),isFetching?/*#__PURE__*/_jsx(\"div\",{style:{width:'100%',height:'100px',position:'relative',marginTop:'40px'},children:/*#__PURE__*/_jsx(Loader,{})}):/*#__PURE__*/_jsx(NewsList,{setNoSeenPotsLength:setNoSeenPotsLength,adminStatus:adminStatus,setTags:setTags,data:data,filterParams:filterParams,setTodayPosts:setTodayPosts,fullScreen:fullScreen})]});};export default/*#__PURE__*/memo(VivoChatSection);","map":{"version":3,"names":["memo","useEffect","useState","s","NewsList","getNews","NewsFilter","arrowLinkIcon","Link","useSearchParams","useSelector","userSelector","Loader","getNewsList","jsx","_jsx","jsxs","_jsxs","VivoChatSection","_ref","ref1","adminStatus","title","fullScreen","data","setData","tags","setTags","filterParams","setFilterParams","params","todayPosts","setTodayPosts","noSeenPotsLength","setNoSeenPotsLength","isFirstLoad","setFirstLoad","isFetching","setFetching","userSeenNews","searchParams","setSearchParams","user","userData","getDataParams","userID","id","fromNumber","limitNumber","filterType","all","categoryID","console","log","then","result","catch","error","setTimeout","interval","setInterval","clearInterval","filterParam","get","length","ref","className","chat","full_screen","children","to","src","alt","style","width","height","position","marginTop"],"sources":["C:/Users/zhuikov/OneDrive - SOFTCOM/Desktop/web/2024/korportal/src/components/VivoChatSectionTest/VivoChatSection.jsx"],"sourcesContent":["import { memo, useEffect, useState } from 'react';\r\nimport s from './VivoChatSection.module.css';\r\nimport NewsList from '../NewsListTest/NewsList';\r\nimport { getNews } from '../../api/api';\r\nimport NewsFilter from '../NewsFilterTest/NewsFilter';\r\nimport arrowLinkIcon from '../../assets/img/icons/redirect-icon.svg';\r\nimport { Link, useSearchParams } from 'react-router-dom';\r\nimport { useSelector } from 'react-redux';\r\nimport { userSelector } from '../../selectors/userSelectors';\r\nimport Loader from '../UI/Loader/Loader';\r\nimport { getNewsList } from '../../api/apiNews';\r\n\r\nconst VivoChatSection = ({ ref1, adminStatus, title, fullScreen }) => {\r\n\tlet [data, setData] = useState([]);\r\n\tlet [tags, setTags] = useState([]);\r\n\tlet [filterParams, setFilterParams] = useState({ params: 'Усі', tags: false });\r\n\tlet [todayPosts, setTodayPosts] = useState(0);\r\n\tlet [noSeenPotsLength, setNoSeenPotsLength] = useState(0);\r\n\tlet [isFirstLoad, setFirstLoad] = useState(false);\r\n\tlet [isFetching, setFetching] = useState(false);\r\n\r\n\tlet userSeenNews = useSelector(userSelector.userSeenNews);\r\n\r\n\tconst [searchParams, setSearchParams] = useSearchParams();\r\n\tlet user = useSelector(userSelector.userData);\r\n\r\n\tuseEffect(() => {\r\n\t\tlet getDataParams = { userID: user.id, fromNumber: 0, limitNumber: 20, filterType: 'Усі', all: 0, categoryID: 1 };\r\n\t\tgetNewsList(getDataParams);\r\n\t\tconsole.log(getDataParams);\r\n\r\n\t\tsetFetching(true);\r\n\t\tgetNews(setData)\r\n\t\t\t.then((result) => {\r\n\t\t\t\tconsole.log(result);\r\n\t\t\t\tresult && setFetching(false);\r\n\t\t\t})\r\n\t\t\t.catch((error) => {\r\n\t\t\t\tsetFetching(false);\r\n\t\t\t\tconsole.log(error);\r\n\t\t\t});\r\n\r\n\t\tsetTimeout(() => {\r\n\t\t\tisFetching && setFetching(false);\r\n\t\t}, 10000);\r\n\r\n\t\tlet interval = setInterval(() => {\r\n\t\t\tgetNews(setData);\r\n\t\t}, 300000);\r\n\t\treturn () => {\r\n\t\t\tclearInterval(interval);\r\n\t\t};\r\n\t}, [user]);\r\n\r\n\tuseEffect(() => {\r\n\t\tlet filterParam = searchParams.get('filter');\r\n\r\n\t\tif (!isFirstLoad && filterParam && filterParam === 'noviews' && data && data.length > 0 && userSeenNews) {\r\n\t\t\tsetFirstLoad(true);\r\n\t\t\tsetFilterParams({ params: 'Не переглянуті', tags: false });\r\n\t\t}\r\n\t}, [data, searchParams, userSeenNews]);\r\n\r\n\treturn (\r\n\t\t<div ref={ref1} className={`${s.chat} section-container ${fullScreen && s.full_screen}`}>\r\n\t\t\t{title && (\r\n\t\t\t\t<Link className=\"title_link\" title=\"Перейти\" to={'feed-news'}>\r\n\t\t\t\t\t<h3>Стрічка останніх новин</h3>\r\n\t\t\t\t\t<img src={arrowLinkIcon} alt=\"\" />\r\n\t\t\t\t</Link>\r\n\t\t\t)}\r\n\t\t\t<NewsFilter\r\n\t\t\t\tnoSeenPotsLength={noSeenPotsLength}\r\n\t\t\t\ttags={tags}\r\n\t\t\t\tsetFilterParams={setFilterParams}\r\n\t\t\t\ttodayPosts={todayPosts}\r\n\t\t\t\tsetData={setData}\r\n\t\t\t\tfullScreen={fullScreen}\r\n\t\t\t/>\r\n\t\t\t{isFetching ? (\r\n\t\t\t\t<div style={{ width: '100%', height: '100px', position: 'relative', marginTop: '40px' }}>\r\n\t\t\t\t\t<Loader />\r\n\t\t\t\t</div>\r\n\t\t\t) : (\r\n\t\t\t\t<NewsList\r\n\t\t\t\t\tsetNoSeenPotsLength={setNoSeenPotsLength}\r\n\t\t\t\t\tadminStatus={adminStatus}\r\n\t\t\t\t\tsetTags={setTags}\r\n\t\t\t\t\tdata={data}\r\n\t\t\t\t\tfilterParams={filterParams}\r\n\t\t\t\t\tsetTodayPosts={setTodayPosts}\r\n\t\t\t\t\tfullScreen={fullScreen}\r\n\t\t\t\t/>\r\n\t\t\t)}\r\n\t\t</div>\r\n\t);\r\n};\r\n\r\nexport default memo(VivoChatSection);\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}